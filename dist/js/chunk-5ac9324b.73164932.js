(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5ac9324b"],{"1e0f":function(e,t,s){"use strict";var n=s("8807"),a=s.n(n);a.a},3568:function(e,t,s){"use strict";var n=s("d03e"),a=s.n(n);a.a},"386b":function(e,t,s){var n=s("5ca1"),a=s("79e5"),i=s("be13"),r=/"/g,o=function(e,t,s,n){var a=String(i(e)),o="<"+t;return""!==s&&(o+=" "+s+'="'+String(n).replace(r,"&quot;")+'"'),o+">"+a+"</"+t+">"};e.exports=function(e,t){var s={};s[e]=t(o),n(n.P+n.F*a((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})),"String",s)}},"386d":function(e,t,s){"use strict";var n=s("cb7c"),a=s("83a1"),i=s("5f1b");s("214f")("search",1,(function(e,t,s,r){return[function(s){var n=e(this),a=void 0==s?void 0:s[t];return void 0!==a?a.call(s,n):new RegExp(s)[t](String(n))},function(e){var t=r(s,e,this);if(t.done)return t.value;var o=n(e),c=String(this),l=o.lastIndex;a(l,0)||(o.lastIndex=0);var u=i(o,c);return a(o.lastIndex,l)||(o.lastIndex=l),null===u?-1:u.index}]}))},4917:function(e,t,s){"use strict";var n=s("cb7c"),a=s("9def"),i=s("0390"),r=s("5f1b");s("214f")("match",1,(function(e,t,s,o){return[function(s){var n=e(this),a=void 0==s?void 0:s[t];return void 0!==a?a.call(s,n):new RegExp(s)[t](String(n))},function(e){var t=o(s,e,this);if(t.done)return t.value;var c=n(e),l=String(this);if(!c.global)return r(c,l);var u=c.unicode;c.lastIndex=0;var g,d=[],m=0;while(null!==(g=r(c,l))){var v=String(g[0]);d[m]=v,""===v&&(c.lastIndex=i(l,a(c.lastIndex),u)),m++}return 0===m?null:d}]}))},"5b6f":function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));s("8e6e"),s("ac6a"),s("456d");var n=s("2909"),a=(s("20d6"),s("55dd"),s("ade3")),i=s("2f62"),r=s("1be9");function o(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function c(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?o(Object(s),!0).forEach((function(t){Object(a["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var l={data:function(){return{group_channel:null,chat_notification_channel:null,app_channel:null,user_list:[],group_list:[],active_chat:null,messages:[],next_url:null,message_loading:!1,sending:!1,contact_list_loading:!1,scrolling:!1}},computed:c(c({},Object(i["c"])(["user"])),{},{onlineUsers:function(){return this.$store.getters["onlineUsers/all_users"]},mentionable_list:function(){var e=this;return this.active_chat?this.active_chat.type&&this.active_chat.users?this.active_chat.users.filter((function(t){return t.id!==e.user.id})):this.active_chat.user?[this.active_chat.user]:[]:[]},is_group_creator:function(){return!!this.active_chat&&this.user.id===this.active_chat.data.group_creator},sorted_messages:function(){return this.messages.length?this.messages.sort((function(e,t){return e.id-t.id})):[]}}),methods:{get_conversation_list:function(e){var t=this;this.contact_list_loading=!0,r["a"].get("api/chat/conversations/list?has_msg_count=true").then((function(s){var n=s.data;t.user_list=n.user_list.map((function(e){var s=t.onlineUsers.findIndex((function(t){return t.id===e.id}));return e.is_online=!!~s,e})),t.group_list=n.group_list,"function"===typeof e&&e(n)})).finally((function(){return t.contact_list_loading=!1}))},open_conversation:function(e,t){this.active_chat=e,this.mark_read_conversation(e),t&&this.get_conversation_messages(e),this.$event.$emit("conversation-opened",e)},mark_read_conversation:function(e){var t=this;e&&r["a"].post("api/chat/conversations/".concat(e.id,"/mark-as-read")).then((function(s){s.data;if(e.type){var n=t.group_list.findIndex((function(t){return t.id===e.id}));~n&&(t.group_list[n].message_count=0)}else{var a=t.user_list.findIndex((function(t){return t.conversation.id===e.id}));~a&&(t.user_list[a].message_count=0)}}))},get_conversation_messages:function(e){var t=this;e&&(this.messages=[],this.message_loading=!0,r["a"].get("api/chat/conversations/".concat(e.id,"/messages?page=1")).then((function(e){var s=e.data;t.messages=s.data,t.next_url=s.next_page_url})).finally((function(){t.message_loading=!1,t.scrollToEnd(".messages-wrapper")})))},get_previous_conversation_messages:function(){var e=this,t=this.$refs.chat_wrapper,s=t.scrollHeight+t.scrollTop;this.message_loading=!0,this.scrolling=!0,r["a"].get(this.next_url).then((function(a){var i,r=a.data;(i=e.messages).push.apply(i,Object(n["a"])(r.data)),e.next_url=r.next_page_url,e.$nextTick((function(){var e=t.scrollHeight-t.scrollTop-s;t.scrollTo(0,e)}))})).finally((function(){e.scrolling=!1,e.message_loading=!1}))},send_conversation_message:function(e,t){var s=this;this.sending=!0;var n=new FormData;n.append("message",e.message),n.append("conversation_id",this.active_chat.id),e.files.length>0&&n.append("file",e.files[0]),r["a"].post("api/chat/conversations/".concat(this.active_chat.id,"/messages"),n).then((function(e){var n=e.data;s.messages.push(n),"function"===typeof t&&t(n)})).finally((function(){s.scrollToEnd(".messages-wrapper"),s.sending=!1,s.$event.$emit("btnsending_off",!1)}))},add_new_message:function(e){this.messages.some((function(t){return t.id===e.id}))||this.messages.push(e)},typing:function(){console.log("typing...")},scrollToEnd:function(e){var t=this.$el.querySelector(e);t&&(t.scrollTop=t.scrollHeight)},scrollToElement:function(e){var t=this;setTimeout((function(){var s=t.$el.getElementsByClassName(e)[t.$el.getElementsByClassName(e).length-1];s&&s.scrollIntoView()}),50)},on_scroll_top:function(e){if(this.next_url&&!this.scrolling){var t=e.target.scrollTop;t<=50&&this.get_previous_conversation_messages()}}}}},"72c1":function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"avatar-wrapper"},[s("ul",{staticClass:"avatars"},[e.cutList.length>0?e._l(e.cutList,(function(t,n){return s("li",{key:n,staticClass:"avatars__item"},[s("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(n){var a=n.on;return[e.deep&&t.user?s("img",e._g({staticClass:"avatars__img",attrs:{src:t.user.image_url}},a)):t?s("img",e._g({staticClass:"avatars__img",attrs:{src:t.image_url}},a)):e._e()]}}],null,!0)},[e.deep&&t.user?s("span",[e._v(e._s(t.user.fullname))]):t?s("span",[e._v(e._s(t.fullname))]):e._e()])],1)})):e._e(),e.less>0?s("li",{staticClass:"avatars__item"},[s("v-tooltip",{attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[s("span",e._g({staticClass:"avatars__others"},n),[e._v("+"+e._s(e.less))])]}}],null,!1,1062212335)},[s("span",{domProps:{innerHTML:e._s(e.lessList)}})])],1):e._e(),e.hasAddMember?s("li",{staticClass:"avatars__item"},[s("span",{staticClass:"avatars__add"},[s("v-icon",{attrs:{dark:""},on:{click:function(t){return e.$emit("add-member")}}},[e._v("add")])],1)]):e._e()],2)])},a=[],i=(s("c5f6"),s("0644")),r=s.n(i),o={inheritAttrs:!1,props:{items:{type:Array,default:function(){return[]}},count:{type:Number,default:3},deep:{type:Boolean,default:!1},hasAddMember:{type:Boolean,default:!1}},computed:{less:function(){return this.items.length-this.count},cutList:function(){return this.items.length<this.count?this.items:r()(this.items).slice(0,this.count)},lessList:function(){var e=this,t=r()(this.items).slice(this.count,this.items.length);return t.length>0?t.map((function(t){return e.deep?t.user?t.user.fullname:"Deleted User":t?t.fullname:"Deleted User"})).join("<br>"):"Deleted User"}}},c=o,l=(s("1e0f"),s("2877")),u=Object(l["a"])(c,n,a,!1,null,"ee48b49c",null);t["a"]=u.exports},7335:function(e,t,s){e.exports=s.p+"img/no-video-preview.6c0717ce.png"},"83a1":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},8807:function(e,t,s){},d03e:function(e,t,s){},dbc2:function(e,t,s){"use strict";var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-card",{attrs:{outlined:"",flat:""}},[e.hasToolbar?[e.conversation?s("v-toolbar",{attrs:{color:"#3b589e",dark:""}},[e.conversation.type?[s("Avatars",{attrs:{items:e.conversation.users,count:3}}),s("v-toolbar-title",{staticClass:"ml-2"},[e._v(e._s(e.conversation.data.group_name))])]:[s("Avatar",{attrs:{user:e.conversation.user}})],s("v-spacer"),e.conversation.type&&e.is_group_creator?s("v-btn",{staticClass:"mr-1",attrs:{icon:""}},[s("v-icon",{on:{click:function(t){return e.$emit("manage-chat-members")}}},[e._v("mdi-account-multiple-plus-outline")])],1):e._e()],2):s("v-toolbar",{attrs:{flat:""}})]:e._e(),e.conversation?s("section",{attrs:{id:"chat-box-wrapper"}},[s("v-card-text",{ref:"chat_wrapper",staticClass:"messages-wrapper",style:"height:"+e.messageHeight+"px;overflow-y:auto;",on:{scroll:e.on_scroll_top}},[s("v-progress-linear",{directives:[{name:"show",rawName:"v-show",value:e.scrolling||e.message_loading,expression:"scrolling || message_loading"}],staticClass:"mb-1",attrs:{color:"primary",indeterminate:"",reverse:""}}),0!==e.messages.length||e.scrolling||e.message_loading?e.sorted_messages.length>0?e._l(e.sorted_messages,(function(e){return s("Message",{key:e.id,attrs:{message:e}})})):e._e():s("empty",{staticStyle:{height:"100%"},attrs:{headline:"No Message yet",icon:"mdi-wechat"}})],2),s("v-divider"),s("v-card-actions",{attrs:{id:"chat-input-wrapper"}},[s("ChatField",{staticClass:"mt-2",attrs:{mentionables:e.mentionable_list},on:{typing:e.typing,"send-message":e.send_conversation_message}})],1)],1):s("empty",{style:"height:"+e.no_active_convo_height+"px;",attrs:{headline:"No active conversation",icon:"mdi-wechat"}})],2)},a=[],i=(s("c5f6"),s("6bdf")),r=s("5b6f"),o=s("72c1"),c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"msg",class:e.me_sender},[e.mine?e._e():s("Avatar",{attrs:{iconOnly:"",user:e.message.sender}}),s("div",{staticClass:"msg-bubble"},[e.mine?s("div",{staticClass:"msg-info"},[s("div",{staticClass:"msg-info-time caption"},[e._v(" "+e._s(e._f("from_now")(e.message.created_at))+" ")]),s("div",{staticClass:"msg-info-name subtitle-2"},[e._v("Me")])]):s("div",{staticClass:"msg-info"},[s("div",{staticClass:"msg-info-name subtitle-2"},[e._v(" "+e._s(e.message.sender.fullname)+" ")]),s("div",{staticClass:"msg-info-time caption"},[e._v(" "+e._s(e._f("from_now")(e.message.created_at))+" ")])]),s("div",{staticClass:"msg-text"},[s("div",{staticClass:"body-2",domProps:{innerHTML:e._s(e.message.body)}}),e.message.media?s("div",[e.isImage?s("Images",{attrs:{media:e.message.media}}):e._e(),e.isDocs?s("Docs",{attrs:{media:e.message.media}}):e._e(),e.isLink?s("Link",{attrs:{media:e.message.media}}):e._e(),e.isVideo?s("Video",{attrs:{media:e.message.media}}):e._e(),e.isOther?s("Other",{attrs:{media:e.message.media}}):e._e()],1):e._e()])])],1)},l=[],u=(s("20d6"),s("579d")),g=s("b0f7"),d=s("8532"),m=s("3fee"),v=s("482d"),f=s("7041"),h={mixins:[u["a"]],components:{Images:g["a"],Docs:d["a"],Link:m["a"],Other:v["a"],Video:f["a"]},props:{id:Number,message:Object},computed:{onlineUsers:function(){return this.$store.getters["onlineUsers/all_users"]},mine:function(){return this.message.sender.id===this.$store.getters.user.id},me_sender:function(){return this.mine?"right-msg":"left-msg"},is_user_online:function(){var e=this,t=this.onlineUsers.findIndex((function(t){return t.id===e.message.sender.id}));return~t?"online":"offline"},isImage:function(){return"images"===this.message.media.category},isVideo:function(){return"videos"===this.message.media.category},isOther:function(){return"others"===this.message.media.category},isLink:function(){return"links"===this.message.media.category},isDocs:function(){return"documents"===this.message.media.category}}},p=h,A=(s("3568"),s("2877")),_=Object(A["a"])(p,c,l,!1,null,"dd40187c",null),C=_.exports,B={name:"ChatBox",mixins:[r["a"]],components:{Avatars:o["a"],ChatField:i["a"],Message:C},props:{messageHeight:{type:Number,default:500},conversation:Object,hasToolbar:{type:Boolean,default:!0}},computed:{no_active_convo_height:function(){return 0===this.messages.length?this.messageHeight+this.chat_input_height:0},chat_input_height:function(){return document.getElementById("chat-input-wrapper")?document.getElementById("chat-input-wrapper").offsetHeight:0}},mounted:function(){var e=this;this.$event.$on("new-chat-message-received",(function(t){e.active_chat&&e.active_chat.id===t.conversation.id&&(e.add_new_message(t),e.scrollToEnd(".messages-wrapper"))}))},watch:{conversation:{handler:function(e){e&&(this.active_chat=e,this.get_conversation_messages(e))},immediate:!0,deep:!0}}},b=B,w=Object(A["a"])(b,n,a,!1,null,"0f3c2b8c",null);t["a"]=w.exports},e55f:function(e,t){e.exports="data:image/jpeg;base64,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"}}]);
//# sourceMappingURL=chunk-5ac9324b.73164932.js.map