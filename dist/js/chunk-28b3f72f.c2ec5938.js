(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-28b3f72f"],{"02b2":function(e,t,i){},"174f":function(e,t,i){},"1e70":function(e,t,i){"use strict";var n=i("2182"),s=i.n(n);s.a},2182:function(e,t,i){},"22b8":function(e,t,i){},"2fcb":function(e,t,i){"use strict";var n=i("02b2"),s=i.n(n);s.a},"7e7e":function(e,t,i){"use strict";var n=i("174f"),s=i.n(n);s.a},a3b6:function(e,t,i){},b51a:function(e,t,i){"use strict";var n=i("a3b6"),s=i.n(n);s.a},bc29:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"members-dropdown"},[i("v-autocomplete",e._b({attrs:{value:e.members,items:e.items,"search-input":e.search,loading:e.isLoading,"item-value":"id","item-text":"first_name","prepend-inner-icon":"search","no-filter":"",chips:"",multiple:e.multiple,clearable:"","hide-details":"","hide-selected":"",color:"#657186",label:"Assign member(s)",filled:"","clear-icon":"mdi-close-circle-outline","append-outer-icon":e.showOuterIcon?"mdi-plus-circle-outline":""},on:{"update:searchInput":function(t){e.search=t},"update:search-input":function(t){e.search=t},"click:append-outer":e.open_add_new_member},scopedSlots:e._u([{key:"selection",fn:function(t){return[i("v-chip",e._b({attrs:{"input-value":t.selected,close:""},on:{click:t.select,"click:close":function(i){return e.remove_chip(t.index)}}},"v-chip",t.attrs,!1),[i("v-avatar",{attrs:{left:""}},[i("v-img",{attrs:{src:t.item.image_url}})],1),e._v(" "+e._s(t.item.fullname)+" ")],1)]}},{key:"item",fn:function(t){return[i("v-list-item",{key:t.item.id,on:{click:function(i){return e.add_to_selected(t.item)}}},[i("v-list-item-avatar",[i("v-img",{attrs:{src:t.item.image_url}})],1),i("v-list-item-content",[i("v-list-item-title",{domProps:{innerHTML:e._s(t.item.fullname)}}),i("v-list-item-subtitle",{domProps:{innerHTML:e._s(t.item.job_title)}})],1),i("v-list-item-action",[e.is_item_active(t.item.id)?e._e():i("v-icon",{attrs:{color:"grey lighten-1"}},[e._v(" check_circle_outline ")]),e.is_item_active(t.item.id)?i("v-icon",{attrs:{color:"success"}},[e._v(" check_circle ")]):e._e()],1)],1)]}}])},"v-autocomplete",e.$attrs,!1))],1)},s=[],o=(i("6762"),i("2fdb"),i("2909")),r=i("0644"),a=i.n(r),l={name:"MembersDropdown",inheritAttrs:!1,props:{members:Array,memberItems:Array,isLoading:Boolean,multiple:{type:Boolean,default:!0},showOuterIcon:{type:Boolean,default:!1}},data:function(){return{items:[],search:null}},watch:{search:function(e){this.$emit("search",e)},memberItems:function(e){this.items=Object(o["a"])(e)}},methods:{members_selected:function(e){this.$emit("update:members",e)},is_item_active:function(e){return this.members.includes(e)},remove_chip:function(e){var t=a()(this.members);t.splice(e,1),this.$emit("update:members",t)},add_to_selected:function(e){this.is_item_active(e.id)||this.members.push(e.id)},open_add_new_member:function(){this.$event.$emit("open-new-member-dialog",!0)}}},c=l,d=(i("b51a"),i("e5d6"),i("2877")),u=Object(d["a"])(c,n,s,!1,null,"7f070529",null);t["a"]=u.exports},bd5b:function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"members-tab"},["grid"===e.view?i("v-progress-linear",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],attrs:{indeterminate:!0}}):e._e(),i("add-dialog",{ref:"add_dialog",attrs:{dialog:e.add_dialog,id:e.id,title:"Add Member(s)",current:e.items},on:{"update:dialog":function(t){e.add_dialog=t},save:function(t){return e.add_item("add_members",t,e.dynamic_api)}}}),i("delete-dialog",{attrs:{"open-dialog":e.delete_dialog,title:"Remove Member",deleteButtonText:"Remove","text-content":"Are you sure you want to remove this member?"},on:{"update:openDialog":function(t){e.delete_dialog=t},"update:open-dialog":function(t){e.delete_dialog=t},delete:function(t){return e.delete_item("delete_member",e.dynamic_api)}}}),i("delete-dialog",{attrs:{"open-dialog":e.bulk_delete_dialog,title:"Remove members",deleteButtonText:"Remove Selected","text-content":"Are you sure you want to remove these members from project?"},on:{"update:openDialog":function(t){e.bulk_delete_dialog=t},"update:open-dialog":function(t){e.bulk_delete_dialog=t},delete:e.bulk_remove_members}}),"list"===e.view?i("VueTable",{key:e.componentKey,attrs:{items:e.items,headers:e.headers,showRowActions:!0,title:e.tableTitle,loading:e.loading,noMoreData:e.noMoreData},on:{"load-more":e.load_more_members,"delete-selected":function(t){return e.open_bulk_delete_dialog(t)}},scopedSlots:e._u([{key:"row-slot",fn:function(t){var n=t.item;return[i("td",{staticClass:"text-cap clickable-td",on:{click:function(t){return e.navigate_to_view_profile(n)}}},[i("Avatar",{attrs:{user:n}})],1),i("td",{staticClass:"email"},[e._v(e._s(n.email))]),i("td",[e._v(e._s(n.telephone?n.telephone.formatInternational:""))]),i("td",{staticClass:"text-cap"},[e._v(e._s(e._f("ucwords")(n.job_title)))]),i("td",[e._v(e._s(n.tasks.length))]),i("Actions",{attrs:{item:n,hasEdit:!1,hasDelete:e.can_add,permissions:e.$_permissions.get("hq_members")},on:{delete:function(t){return e.open_delete_dialog(n)},view:function(t){return e.navigate_to_view_profile(n)}}})]}},{key:"empty-slot",fn:function(){return[i("v-btn",{attrs:{dark:"",color:"#3b589e"},on:{click:function(t){e.add_dialog=!0}}},[e._v("Add "+e._s(e._f("ucwords")(e.type))+" Member")])]},proxy:!0}],null,!1,3673324593)},[i("template",{slot:"header-toolbar"},[i("table-header",{attrs:{noListButton:!1,noButton:!e.can_add,noGridButton:!1},on:{click:function(t){e.add_dialog=!0},"click-list-view":function(t){return e.setPreferredView("list")},"click-grid-view":function(t){return e.setPreferredView("grid")}}})],1)],2):i("VueGrid",{key:e.componentKey,attrs:{items:e.items,permissions:e.$_permissions.get("hq_members"),noMoreData:e.noMoreData,hasFooter:!1,showProjectCount:!1},on:{"load-more":e.load_more_members,delete:e.open_delete_dialog,edit:e.open_edit_dialog}},[i("template",{staticClass:"icons",slot:"header-toolbar"},[i("table-header",{attrs:{noListButton:!1,noButton:!e.can_add,noGridButton:!1},on:{click:function(t){e.add_dialog=!0},"click-list-view":function(t){return e.setPreferredView("list")},"click-grid-view":function(t){return e.setPreferredView("grid")}}})],1)],2)],1)},s=[],o=(i("8e6e"),i("456d"),i("8615"),i("20d6"),i("ac6a"),i("ade3")),r=(i("c5f6"),i("e06e")),a=i("1be9"),l=i("5b70"),c=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-layout",{attrs:{"justify-center":""}},[i("custom-dialog",{ref:"dialog",attrs:{title:e.title,open:e.open,"button2-text":"Save",mainBtnDisabled:e.disableSave},on:{"update:open":function(t){e.open=t},button1:e.cancel,button2:e.save}},[i("template",{slot:"content"},[i("members-dropdown",{attrs:{members:e.members.selected,"member-items":e.members.items,"is-loading":e.members.loading},on:{"update:members":function(t){return e.$set(e.members,"selected",t)},search:e.filter_members}})],1)],2)],1)},d=[],u=(i("6762"),i("2fdb"),function(e){return a["a"].get("api/projects/".concat(e,"/new-members"))}),m=i("bc29"),p=i("57e5"),_=i("0644"),f=i.n(_),b={name:"AddDialog",components:{MembersDropdown:m["a"],CustomDialog:p["a"]},props:{dialog:Boolean,title:String,id:[Number,String]},data:function(){return{open:!1,name:"",members:{selected:[],items:[],allItems:[],loading:!1}}},computed:{disableSave:function(){return!this.members.selected.length}},watch:{dialog:function(e){e&&this.getProjectMembers(),this.open=e},open:function(e){this.$emit("update:dialog",e)}},methods:{getProjectMembers:function(){var e=this;this.members.loading=!0,u(this.id).then((function(t){var i=t.data;e.members.allItems=i,e.members.items=i})).finally((function(){return e.members.loading=!1}))},cancel:function(){this.open=!1},save:function(){this.disableSave||this.$emit("save",this.members.selected)},clear_and_close:function(){Object.assign(this.$data,this.$options.data.apply(this)),this.cancel()},filter_members:function(e){var t=f()(this.members.allItems);if(e){var i=t.filter((function(t){return t.first_name.toLowerCase().includes(e.toLowerCase())||t.last_name.toLowerCase().includes(e.toLowerCase())}));this.$set(this.members,"items",i)}else this.members.items=t}}},h=b,v=(i("2fcb"),i("2877")),g=Object(v["a"])(h,c,d,!1,null,"5eca4cd6",null),w=g.exports,y=i("0ebe"),k=i("ee09"),j=i("36ee"),x=i("29d6"),O=i("2f62");function $(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function S(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?$(Object(i),!0).forEach((function(t){Object(o["a"])(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):$(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var D={name:"MembersTab",mixins:[r["a"]],components:{VueTable:y["a"],AddDialog:w,DeleteDialog:l["a"],Actions:k["a"],VueGrid:j["a"],TableHeader:x["a"]},inheritAttrs:!1,props:{id:[Number,String]},data:function(){return{headers:[{text:"Member",sortable:!1},{text:"Email",value:"email"},{text:"Telephone",sortable:!1},{text:"Position",value:"position"},{text:"Tasks",value:"tasks"},{text:"Action",value:"action",align:"center",width:"140px"}],sortList:[{title:"Sort by member"},{title:"Sort by email"},{title:"Sort by telephone"},{title:"Sort by position"},{title:"Sort by tasks"}],table_config:{route_name:"project_preview",add_message:"New Members(s) added successfully!",delete_message:"Members deleted successfully!",refresh_table_message:"Table refreshed",refresh_table_api_name:"paginate_tab_members_table"}}},computed:S(S({},Object(O["c"])(["user"])),{},{dynamic_api:function(){return"api/projects/".concat(this.id,"/member")},permissions:function(){return this.$_permissions.get("hq_members")},type:function(){return this.$route.params.type||"project"},tableTitle:function(){return"project"===this.type?"Project Members":"Service Members"},paths:function(){return[{text:"Dashboard",disabled:!1,route:{name:"default-content"}},{text:this.type,disabled:!1,route:{path:"/dashboard/".concat(this.type,"/preview/").concat(this.id)}},{text:"Members",disabled:!0,route:null}]},can_add:function(){return!(!this.user.is_admin&&!this.user.is_manager)||this.permissions&&this.permissions.create}}),mounted:function(){this.$event.$emit("path-change",this.paths),this.view=this.getPreferredView(),this.load_users()},methods:{load_users:function(){this.fill_table_via_url(this.dynamic_api,!0)},load_more_members:function(){this.load_more_via_url(this.dynamic_api)},bulk_remove_members:function(){var e=this,t={ids:this.selected.map((function(e){return e.id}))};a["a"].delete("api/projects/".concat(this.id,"/member/bulk-delete"),{data:t}).then((function(t){var i=t.data;i.ids.forEach((function(t){var i=e.items.findIndex((function(e){return e.id===t.user_id}));~i&&e.items.splice(i,1)})),e.bulk_delete_dialog=!1,e.selected=[],e.$event.$emit("clear_selected"),e.$event.$emit("open_snackbar",i.message)})).finally((function(){e.$event.$emit("btnloading_off",!1)}))},can_be_deleted:function(e){return!("Administrator"===e.job_title||"Client"===e.job_title)},navigate_to_view_profile:function(e){var t=Object.values(e.user_roles);t[0].indexOf("client")>=0||t[0].indexOf("agent")>=0?this.$router.push("/dashboard/clients/profile/".concat(e.id)):this.$router.push("/dashboard/team/profile/".concat(e.id))}}},M=D,P=(i("1e70"),Object(v["a"])(M,n,s,!1,null,"025b5070",null));t["default"]=P.exports},e5d6:function(e,t,i){"use strict";var n=i("22b8"),s=i.n(n);s.a},ee09:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("td",{staticClass:"table-actions",attrs:{align:"center"}},[e.hasEdit?i("v-tooltip",{directives:[{name:"show",rawName:"v-show",value:e.can_edit,expression:"can_edit"}],attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[i("v-btn",e._g({attrs:{dense:"",icon:""},on:{click:function(t){return e.handle_action("edit")}}},n),[i("v-icon",[e._v(e._s(e.editIcon))])],1)]}}],null,!1,4170341451)},[i("span",[e._v("Edit")])]):e._e(),e.hasView?i("v-tooltip",{directives:[{name:"show",rawName:"v-show",value:e.can_view,expression:"can_view"}],attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[i("v-btn",e._g({attrs:{dense:"",icon:""},on:{click:function(t){return e.handle_action("view")}}},n),[i("v-icon",[e._v(e._s(e.viewIcon))])],1)]}}],null,!1,701816587)},[i("span",[e._v("View")])]):e._e(),e.hasDelete?i("v-tooltip",{directives:[{name:"show",rawName:"v-show",value:e.can_delete,expression:"can_delete"}],attrs:{top:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[i("v-btn",e._g({attrs:{dense:"",icon:""},on:{click:function(t){return e.handle_action("delete")}}},n),[i("v-icon",[e._v(e._s(e.deleteIcon))])],1)]}}],null,!1,4164065227)},[i("span",[e._v("Delete")])]):e._e(),e._t("extra")],2)},s=[],o={props:{item:{type:Object,default:null},permissions:{type:Object,default:function(){return{delete:!0,update:!0,create:!0,view:!0}}},editIcon:{type:String,default:"mdi-circle-edit-outline"},viewIcon:{type:String,default:"mdi-eye-circle-outline"},deleteIcon:{type:String,default:"mdi-delete-circle-outline"},hasDelete:{type:Boolean,default:!0},hasEdit:{type:Boolean,default:!0},hasView:{type:Boolean,default:!0}},computed:{logged_user:function(){return this.$store.getters.user}},methods:{handle_action:function(e){this.item&&this.$emit(e,this.item)},can_delete:function(){return!!this.logged_user.is_admin||this.permissions&&this.permissions.delete},can_edit:function(){return!!this.logged_user.is_admin||this.permissions&&this.permissions.update},can_view:function(){return!!this.logged_user.is_admin||this.permissions&&this.permissions.view}}},r=o,a=(i("7e7e"),i("2877")),l=Object(a["a"])(r,n,s,!1,null,null,null);t["a"]=l.exports}}]);
//# sourceMappingURL=chunk-28b3f72f.c2ec5938.js.map