(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b4f1d612"],{"4f0a":function(t,e,i){},"55af":function(t,e,i){"use strict";var a=i("d5dd"),n=i.n(a);n.a},a09c:function(t,e,i){},a5da:function(t,e,i){t.exports=i.p+"img/delete.ba632ac8.svg"},b98e:function(t,e,i){"use strict";var a=i("4f0a"),n=i.n(a);n.a},d5dd:function(t,e,i){},f17a:function(t,e,i){"use strict";var a=i("a09c"),n=i.n(a);n.a},fec3:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"files__tab"},[a("LinkDialog",{ref:"link_dialog",on:{save:t.addLink}}),a("delete-dialog",{attrs:{"open-dialog":t.delete_dialog,title:"Delete File","text-content":"Are you sure you want to delete this file?"},on:{"update:openDialog":function(e){t.delete_dialog=e},"update:open-dialog":function(e){t.delete_dialog=e},delete:t.delete_item}}),a("div",{staticClass:"drop__files"},[a("div",{staticClass:"drop__files_body"},[a("CustomDropzone",{ref:"dropzone",attrs:{needConfirmation:!0,duplicateCheck:!0,options:t.dropzoneOptions,useCustomSlot:!0,dictFileTooBig:"File too big",dictInvalidFileType:"Invalid file type"},on:{success:t.file_added,failed:t.file_failed,"open-add-link-dialog":t.open_link_dialog,"upload-this-files":t.manual_upload}})],1)]),a("v-dialog",{attrs:{width:"500"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("img",{attrs:{src:t.url,width:"500"}})]),a("v-card",{staticClass:"p-2"},[a("v-row",{staticClass:"pa-3",attrs:{"no-gutters":""}},[a("v-col",{attrs:{md:"10",sm:"9",xs:"12"}},t._l(t.toolbarItems,(function(e){return a("ToolbarItem",{key:e.id,attrs:{icon:e.icon,"icon-text":e.iconText,"icon-class":e.className,"is-active":e.type===t.filter},on:{click:function(i){t.filter=e.type}}})})),1),a("v-spacer"),a("v-col",[a("v-spacer"),a("v-btn",{attrs:{icon:"",text:"",right:""},on:{click:function(e){return t.setPreferredView("list")}}},[a("v-icon",{attrs:{color:"list"==t.view?"primary":""}},[t._v("list")])],1),a("v-btn",{attrs:{icon:"",text:"",right:""},on:{click:function(e){return t.setPreferredView("grid")}}},[a("v-icon",{attrs:{color:"grid"==t.view?"primary":""}},[t._v("grid_on")])],1)],1)],1),"grid"==t.view?a("v-card",[a("v-container",{attrs:{fluid:"","grid-list-md":""}},[t.filteredItems.length?a("v-layout",{attrs:{wrap:""}},t._l(t.filteredItems,(function(e){return a("v-col",{key:e.id,attrs:{xs:"12",sm:"4",md:"3"}},[a("v-card",[a("Media",{attrs:{height:150,media:e},on:{"click-main":function(i){return t.pop(e.public_url)}}}),a("v-card-text",[a("v-list",{staticClass:"pa-0",attrs:{dense:""}},[a("v-list-item",{staticClass:"pa-0",attrs:{"two-line":""}},[a("v-list-item-content",[a("v-list-item-subtitle",[a("div",{staticClass:"break-word-container",attrs:{title:e.name}},[t._v(" "+t._s(t._f("str_limit")(e.name,25))+" ")])]),a("v-list-item-subtitle",[a("span",{staticClass:"grey--text"},[t._v(" Added by: "+t._s(e.custom_properties.user.first_name))])])],1)],1)],1)],1),a("v-card-actions",[a("span",{staticClass:"overline"},[t._v(t._s(e.custom_properties.ext))]),a("v-spacer"),"link"!==e.mime_type?a("v-btn",{attrs:{small:"",depressed:"",title:"Download",href:e.download_url}},[a("v-icon",{attrs:{small:""}},[t._v("cloud_download")])],1):a("v-btn",{attrs:{small:"",depressed:"",title:"Go to link"},on:{click:function(i){return t.goto_link(e.download_url)}}},[a("v-icon",{attrs:{small:""}},[t._v("link")])],1),t.can_delete?a("v-btn",{attrs:{small:"",depressed:"",title:"Delete"},on:{click:function(i){return t.open_delete_dialog(e)}}},[a("v-icon",{attrs:{small:""}},[t._v("delete")])],1):t._e()],1)],1)],1)})),1):t._e(),t.filteredItems.length?a("v-row",{attrs:{"no-gutters":""}},[a("v-spacer"),a("v-card-actions",{staticClass:"py-2"},[!0===t.noMoreData?a("v-btn",{attrs:{tile:"",text:"",disabled:""}},[t._v("NO MORE DATA")]):a("v-btn",{attrs:{tile:"",text:"",loading:t.btnloading},on:{click:t.get_more_files}},[t._v("LOAD MORE")])],1),a("v-spacer")],1):a("Empty",{attrs:{headline:"No file found"}})],1)],1):"list"==t.view?a("VueTable",{key:t.componentKey,attrs:{items:t.filteredItems,headers:t.headers,showRowActions:!0,icon:"widgets",title:"Files",loading:t.loading,noMoreData:t.noMoreData,permission:t.$_permissions.get("hq_files")},on:{"load-more":t.get_more_files},scopedSlots:t._u([{key:"row-slot",fn:function(e){var n=e.item;return[a("td",{on:{click:function(e){return t.pop(n.public_url)}}},[a("Media",{attrs:{height:50,width:50,media:n,size:"lg"}})],1),a("td",{staticClass:"text-upper"},[t._v(t._s(n.custom_properties.ext))]),a("td",{staticClass:"text-cap"},[t._v(t._s(n.name))]),a("td",{staticClass:"text-cap"},[t._v(" "+t._s(n.custom_properties.user.first_name)+" ")]),a("td",{staticClass:"text-cap"},[t._v("Project")]),a("td",{staticClass:"text-xs-center"},["link"!==n.mime_type?a("v-btn",{attrs:{fab:"",small:"",depressed:"",title:"Download",href:n.download_url}},[a("v-icon",[t._v("cloud_download")])],1):a("v-btn",{attrs:{fab:"",text:"",small:"",depressed:"",title:"Go to link"},on:{click:function(e){return t.goto_link(n.download_url)}}},[a("v-icon",[t._v("link")])],1),t.can_delete?a("v-btn",{attrs:{fab:"",small:"",text:"",depressed:"",title:"Delete"},on:{click:function(e){return t.open_delete_dialog(n)}}},[a("img",{attrs:{src:i("a5da"),alt:""}})]):t._e()],1)]}}])}):t._e()],1)],1)},n=[],s=i("7618"),o=(i("20d6"),i("768b")),l=(i("ac6a"),i("6762"),i("2fdb"),i("c5f6"),i("e06e")),r=i("579d"),c=i("7eac"),d=i("1be9"),u=function(t){return d["a"].delete("api/file/".concat(t))},p=function(t,e){return d["a"].post("api/projects/".concat(t,"/link"),e)},f=function(t,e){return d["a"].get("api/projects/".concat(t,"/file?page=").concat(e.page,"&type=").concat(e.type))},_=i("0ebe"),m=i("29d6"),v=i("8b7e"),g=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"link-dialog"},[i("CustomDialog",{ref:"dialog",attrs:{open:t.dialog,title:"File URL","button1-text":"Cancel","button2-text":"Save"},on:{"update:open":function(e){t.dialog=e},button1:t.close_dialog,button2:t.saveClicked},scopedSlots:t._u([{key:"content",fn:function(){return[i("v-layout",{staticClass:"custom-dialog",attrs:{wrap:""}},[i("v-flex",{attrs:{xs12:"",md12:""}},[i("v-text-field",{attrs:{label:"File URL",type:"url",solo:"","hide-details":"",color:"#657186"},model:{value:t.url,callback:function(e){t.url="string"===typeof e?e.trim():e},expression:"url"}})],1)],1)]},proxy:!0}])})],1)},h=[],b=i("57e5"),k={components:{CustomDialog:b["a"]},data:function(){return{dialog:!1,url:null}},methods:{openDialog:function(){this.dialog=!0},close_dialog:function(){this.dialog=!1},closeAndClearDialog:function(){Object.assign(this.$data,this.$options.data.apply(this))},saveClicked:function(){this.url&&this.$emit("save",{url:this.url})}}},y=k,x=i("2877"),w=Object(x["a"])(y,g,h,!1,null,null,null),C=w.exports,$=i("5b70"),D=function(t,e){var i=e._c;return i("v-btn",e._g({staticClass:"mr-1",class:["button",{active:e.props.isActive}],attrs:{color:"#b3b7c3",medium:"",text:""}},e.listeners),[i("v-icon",{class:e.props.iconClass,attrs:{dark:"",left:""}},[e._v(e._s(e.props.icon))]),e._v(" "+e._s(e.props.iconText)+" ")],1)},T=[],j={props:{icon:String,iconText:String,iconClass:String,isActive:Boolean}},F=j,O=(i("f17a"),Object(x["a"])(F,D,T,!0,null,"7e1a0efa",null)),A=O.exports,I=i("4752"),N={name:"FilesTab",mixins:[l["a"],r["a"]],components:{VueTable:_["a"],TableHeader:m["a"],CustomDropzone:v["a"],LinkDialog:C,DeleteDialog:$["a"],ToolbarItem:A,Empty:I["a"]},props:{id:[String,Number]},data:function(){return{headers:[{text:"Thumbnail",value:"thumbnail",sortable:!1},{text:"Filetype",value:"filetype"},{text:"Filename",value:"filename",width:"35%"},{text:"Added by",value:"member"},{text:"Project",value:"project",sortable:!1},{text:"Action",value:"action",sortable:!1,align:"center",width:"120px"}],table_config:{route_name:"project_preview",add_message:"New File(s) added successfully!",delete_message:"File deleted successfully!",refresh_table_message:"Table refreshed",refresh_table_api_name:"paginate_tab_files_table"},btnloading:!1,url:"",dialog:!1,filter:"all",toolbarItems:[{id:1,className:"all",type:"all",icon:"select_all",iconText:"All"},{id:2,className:"image",type:"image",icon:"image",iconText:"Image"},{id:3,className:"video",type:"video",icon:"video_library",iconText:"Video"},{id:4,className:"docs",type:"document",icon:"file_copy",iconText:"Docs"},{id:5,className:"links",type:"link",icon:"link",iconText:"Links"},{id:6,className:"other",type:"other",icon:"settings_applications",iconText:"Other"}],log_id:null}},computed:{permissions:function(){return this.$_permissions.get("hq_files")},filteredItems:function(){var t=this;return"all"===this.filter?this.items:this.items.filter((function(e){return e.category.includes(t.filter)}))},user:function(){return this.$store.getters.user},dropzoneOptions:function(){return{autoProcessQueue:!1,thumbnailWidth:150,timeout:5e5,addRemoveLinks:!0,maxFiles:10,url:c["a"].apiHostBaseURL+"/api/projects/".concat(this.id,"/file"),headers:{Authorization:"Bearer "+localStorage.getItem("token")}}},dynamic_api:function(){return"api/projects/".concat(this.id,"/file")},can_delete:function(){return!!this.user.is_admin||this.permissions&&this.permissions.delete}},created:function(){this.view=this.getPreferredView(),this.get_files()},methods:{get_files:function(){var t=this;this.item=[];var e={page:1,type:this.filter};f(this.id,e).then((function(e){var i=e.data;t.items=i.data,t.pagination.current=i.current_page,t.pagination.total=i.last_page,t.hasMoreData()})).finally((function(){t.loading=!1,t.$event.$emit("btnloading_off",!1)}))},get_more_files:function(){var t=this;this.item=[];var e={page:this.pagination.current+1,type:"all"};f(this.id,e).then((function(e){var i=e.data;i.data.forEach((function(e){t.items.push(e)})),t.pagination.current=i.current_page,t.pagination.total=i.last_page,t.hasMoreData()})).finally((function(){t.loading=!1,t.$event.$emit("btnloading_off",!1)}))},manual_upload:function(){this.$refs.dropzone.process_queue()},pop:function(t){this.dialog=!0,this.url=t},sortFile:function(t){alert("This feature is under-construction.")},file_added:function(t){var e=Object(o["a"])(t,2),i=e[0],a=e[1];this.$event.$emit("open_snackbar","File(s) uploaded successfully");var n="string"===typeof a?JSON.parse(a):a;this.items.unshift(n),this.$refs.dropzone.remove_file(i)},open_link_dialog:function(){this.$refs.link_dialog.openDialog()},addLink:function(t){var e=this;p(this.id,t).then((function(t){var i=t.data;e.items.push(i),e.$refs.link_dialog.closeAndClearDialog(),e.$event.$emit("open_snackbar","New link added!")})).finally((function(){return e.$event.$emit("btnloading_off",!1)}))},delete_item:function(){var t=this;u(this.delete_item_id).then((function(){var e=t.items.findIndex((function(e){return e.id===t.delete_item_id}));~e&&(t.items.splice(e,1),t.delete_item_id=null,t.delete_dialog=!1,t.$event.$emit("open_snackbar",t.table_config.delete_message))})).finally((function(){return t.$event.$emit("btnloading_off",!1)}))},file_failed:function(t){var e=Object(o["a"])(t,2),i=(e[0],e[1]);this.$event.$emit("open_snackbar","object"===Object(s["a"])(i)?i[0]:i,"error")},goto_link:function(t){window.open(t)}}},L=N,S=(i("55af"),i("b98e"),Object(x["a"])(L,a,n,!1,null,"802f0eec",null));e["default"]=S.exports}}]);
//# sourceMappingURL=chunk-b4f1d612.55e59bc7.js.map