{"version":3,"sources":["webpack:///./src/modules/Chat/api.js","webpack:///./src/modules/ProjectPreview-Messages/subpages/ClientMessages/ClientMessages.vue?23d3","webpack:///./src/modules/ProjectPreview-Messages/components/ManageClientChatMember.vue?7f16","webpack:///./src/modules/ProjectPreview-Messages/subpages/ClientMessages/ClientMessages.vue?cbb9","webpack:///./src/modules/ProjectPreview-Messages/components/ManageClientChatMember.vue?7d26","webpack:///src/modules/ProjectPreview-Messages/components/ManageClientChatMember.vue","webpack:///./src/modules/ProjectPreview-Messages/components/ManageClientChatMember.vue?d628","webpack:///./src/modules/ProjectPreview-Messages/components/ManageClientChatMember.vue","webpack:///src/modules/ProjectPreview-Messages/subpages/ClientMessages/ClientMessages.vue","webpack:///./src/modules/ProjectPreview-Messages/subpages/ClientMessages/ClientMessages.vue?e86c","webpack:///./src/modules/ProjectPreview-Messages/subpages/ClientMessages/ClientMessages.vue"],"names":["api_to","get_chat_list","request","get","get_chat_list_only","get_groupchat_list","get_members_list","convo_id","get_messages","id","get_more_messages","page","get_group_messages","get_group_more_messages","send_message","payload","post","headers","send_group_message","save_group","update_members_list","remove_from_group","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","open_manage_member_dialog","_v","_e","ref","noMoreData","loading","load_previous","items","length","can_send_message","staticStyle","_l","messages","message","key","mentionables","$event","sendMessage","activeChat","staticRenderFns","model","value","callback","$$v","dialog","expression","clear_and_close","filter_users","search","filtered_by_search","item","title","selected","image_url","domProps","_s","fullname","directives","name","rawName","all_selected","can_be_remove","btnloading","update_members","props","conversation","Object","data","all_users","computed","loggedUser","$store","getters","user","methods","open_dialog","users","map","is_company_owner","uroles","includes","roles","select","index","is_selected","splice","push","filter_users_for_selected","selected_ids","members","setTimeout","component"],"mappings":"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","file":"js/chunk-964dfdf8.1375c15e.js","sourcesContent":["import request from '@/services/axios_instance'\n\nexport const api_to = {\n  get_chat_list() {\n    return request.get(`api/chat/list?for=project&has_msg_count=true`)\n  },\n  get_chat_list_only() {\n    return request.get(`api/chat/list?for=project`)\n  },\n  get_groupchat_list() {\n    return request.get(`api/chat/group/list?for=project&has_msg_count=true`)\n  },\n  get_members_list(convo_id) {\n    return request.get(`api/chat/group/members/${convo_id}`)\n  },\n  get_messages(id) {\n    return request.get(`api/chat/private/${id}`)\n  },\n  get_more_messages(id, page) {\n    return request.get(`api/chat/private/${id}?page=${page + 1}`)\n  },\n  get_group_messages(id) {\n    return request.get(`api/chat/group/private/${id}`)\n  },\n  get_group_more_messages(id, page) {\n    return request.get(`api/chat/group/private/${id}?page=${page + 1}`)\n  },\n  send_message(payload) {\n    return request.post(`api/chat/private`, payload, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    })\n  },\n  send_group_message(payload) {\n    return request.post(`api/chat/group/private`, payload, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    })\n  },\n  save_group(payload) {\n    return request.post(`api/chat/group`, payload)\n  },\n  update_members_list(payload) {\n    return request.post(`api/chat/group/update-members`, payload)\n  },\n  remove_from_group(payload) {\n    return request.post(`api/chat/group/remove-member`, payload)\n  }\n}\n","import mod from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClientMessages.vue?vue&type=style&index=0&id=62089150&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClientMessages.vue?vue&type=style&index=0&id=62089150&lang=scss&scoped=true&\"","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ManageClientChatMember.vue?vue&type=style&index=0&id=1ed75cb6&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ManageClientChatMember.vue?vue&type=style&index=0&id=1ed75cb6&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"message__body team-messages\"},[(_vm.can_manage_members)?_c('v-system-bar',{attrs:{\"lights-out\":\"\",\"height\":40}},[_c('v-spacer'),_c('v-btn',{attrs:{\"text\":\"\",\"small\":\"\"},on:{\"click\":_vm.open_manage_member_dialog}},[_vm._v(\"Manage Members \"),_c('v-icon',{attrs:{\"right\":\"\"}},[_vm._v(\"settings\")])],1)],1):_vm._e(),_c('div',{ref:\"messages-container\",staticClass:\"messages\"},[(_vm.can_send_message)?_c('v-row',{staticClass:\"pa-3\",attrs:{\"no-gutters\":\"\"}},[_c('v-spacer'),_c('v-col',[(_vm.noMoreData === false && !_vm.loading)?_c('v-btn',{staticClass:\"view__more_btn overline\",attrs:{\"text\":\"\"},on:{\"click\":_vm.load_previous}},[_vm._v(\"Load Previous Messages\")]):_vm._e()],1),_c('v-spacer')],1):_vm._e(),(_vm.loading)?_c('v-progress-linear',{attrs:{\"indeterminate\":true}}):_vm._e(),(_vm.items.length && _vm.can_send_message)?_c('v-row',{attrs:{\"no-gutters\":\"\"}},[_c('v-col',{staticClass:\"px-3 py-2\",staticStyle:{\"min-height\":\"350px\"},attrs:{\"md\":\"12\"}},_vm._l((_vm.messages(_vm.items)),function(message){return _c('Message',{key:message.id,attrs:{\"message\":message}})}),1)],1):(!_vm.can_send_message)?_c('div',{staticClass:\"no-messages\"},[_c('Empty',{attrs:{\"headline\":\"Client messages unavailable! \"}})],1):_c('div',{staticClass:\"no-messages\"},[_c('Empty',{attrs:{\"headline\":\"No messages yet\"}})],1)],1),_c('div',{staticClass:\"write px-3\"},[(_vm.can_send_message)?_c('ChatField',{staticClass:\"mt-2\",attrs:{\"mentionables\":_vm.mentionables},on:{\"typing\":function($event){},\"send-message\":_vm.sendMessage}}):_vm._e()],1),_c('ManageClientChatMember',{ref:\"manage_group_members_dialog\",attrs:{\"conversation\":_vm.activeChat}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.conversation)?_c('div',{staticClass:\"text-center\"},[_c('v-dialog',{attrs:{\"max-width\":\"800\",\"persistent\":\"\",\"scrollable\":\"\"},model:{value:(_vm.dialog),callback:function ($$v) {_vm.dialog=$$v},expression:\"dialog\"}},[_c('v-card',[_c('v-card-title',{staticClass:\"headline grey lighten-2\",attrs:{\"primary-title\":\"\"}},[_vm._v(\" Manage Members \"),_c('v-spacer'),_c('v-icon',{on:{\"click\":function($event){return _vm.clear_and_close()}}},[_vm._v(\"close\")])],1),_c('v-card-text',[_c('v-container',[_c('v-row',[_c('v-flex',{attrs:{\"sm12\":\"\",\"md8\":\"\"}},[_c('v-text-field',{attrs:{\"solo\":\"\",\"label\":\"Search for people to add\",\"required\":\"\",\"clearable\":\"\",\"prepend-inner-icon\":\"search\"},on:{\"keydown\":_vm.filter_users,\"click:clear\":_vm.filter_users},model:{value:(_vm.search),callback:function ($$v) {_vm.search=$$v},expression:\"search\"}}),(_vm.filtered_by_search.length > 0)?_c('v-list',{attrs:{\"id\":\"filtered_by_search_wrapper\"}},_vm._l((_vm.filtered_by_search),function(item){return _c('v-list-item',{key:item.title,on:{\"click\":function($event){return _vm.selected(item)}}},[_c('v-list-item-avatar',[_c('v-img',{attrs:{\"src\":item.image_url}})],1),_c('v-list-item-content',[_c('v-list-item-title',{domProps:{\"textContent\":_vm._s(item.fullname)}})],1),_c('v-list-item-icon',[_c('v-icon',{directives:[{name:\"show\",rawName:\"v-show\",value:(item.is_selected),expression:\"item.is_selected\"}],attrs:{\"color\":\"success\"}},[_vm._v(\"mdi-checkbox-marked-circle\")])],1)],1)}),1):_vm._e()],1),_c('v-flex',{attrs:{\"sm12\":\"\",\"md4\":\"\"}},[_c('v-list',{attrs:{\"id\":\"all_selected_wrapper\"}},[_c('v-subheader',[_vm._v(\"Selected (\"+_vm._s(_vm.all_selected.length)+\")\")]),_vm._l((_vm.all_selected),function(item){return (_vm.all_selected.length > 0)?_c('v-list-item',{key:item.title},[_c('v-list-item-avatar',[_c('v-img',{attrs:{\"src\":item.image_url}})],1),_c('v-list-item-content',[_c('v-list-item-subtitle',{domProps:{\"textContent\":_vm._s(item.fullname)}})],1),(_vm.can_be_remove(item))?_c('v-list-item-icon',[_c('v-icon',{attrs:{\"small\":\"\",\"color\":\"danger\"},on:{\"click\":function($event){return _vm.selected(item)}}},[_vm._v(\"close\")])],1):_vm._e()],1):_vm._e()})],2)],1)],1)],1)],1),_c('v-divider'),_c('v-card-actions',[_c('v-spacer'),_c('v-btn',{on:{\"click\":_vm.clear_and_close}},[_vm._v(\" Cancel \")]),_c('v-btn',{attrs:{\"color\":\"primary\",\"loading\":_vm.btnloading},on:{\"click\":_vm.update_members}},[_vm._v(\" Save \")])],1)],1)],1)],1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"text-center\" v-if=\"conversation\">\n    <v-dialog v-model=\"dialog\" max-width=\"800\" persistent scrollable>\n      <v-card>\n        <v-card-title class=\"headline grey lighten-2\" primary-title>\n          Manage Members\n          <v-spacer></v-spacer>\n          <v-icon @click=\"clear_and_close()\">close</v-icon>\n        </v-card-title>\n\n        <v-card-text>\n          <v-container>\n            <v-row>\n              <v-flex sm12 md8>\n                <v-text-field\n                  solo\n                  label=\"Search for people to add\"\n                  required\n                  clearable\n                  prepend-inner-icon=\"search\"\n                  v-model=\"search\"\n                  @keydown=\"filter_users\"\n                  @click:clear=\"filter_users\"\n                ></v-text-field>\n\n                <v-list\n                  v-if=\"filtered_by_search.length > 0\"\n                  id=\"filtered_by_search_wrapper\"\n                >\n                  <v-list-item\n                    v-for=\"item in filtered_by_search\"\n                    :key=\"item.title\"\n                    @click=\"selected(item)\"\n                  >\n                    <v-list-item-avatar>\n                      <v-img :src=\"item.image_url\"></v-img>\n                    </v-list-item-avatar>\n\n                    <v-list-item-content>\n                      <v-list-item-title\n                        v-text=\"item.fullname\"\n                      ></v-list-item-title>\n                    </v-list-item-content>\n\n                    <v-list-item-icon>\n                      <v-icon v-show=\"item.is_selected\" color=\"success\"\n                        >mdi-checkbox-marked-circle</v-icon\n                      >\n                    </v-list-item-icon>\n                  </v-list-item>\n                </v-list>\n              </v-flex>\n              <v-flex sm12 md4>\n                <v-list id=\"all_selected_wrapper\">\n                  <v-subheader\n                    >Selected ({{ all_selected.length }})</v-subheader\n                  >\n                  <v-list-item\n                    v-if=\"all_selected.length > 0\"\n                    v-for=\"item in all_selected\"\n                    :key=\"item.title\"\n                  >\n                    <v-list-item-avatar>\n                      <v-img :src=\"item.image_url\"></v-img>\n                    </v-list-item-avatar>\n\n                    <v-list-item-content>\n                      <v-list-item-subtitle\n                        v-text=\"item.fullname\"\n                      ></v-list-item-subtitle>\n                    </v-list-item-content>\n\n                    <v-list-item-icon v-if=\"can_be_remove(item)\">\n                      <v-icon @click=\"selected(item)\" small color=\"danger\"\n                        >close</v-icon\n                      >\n                    </v-list-item-icon>\n                  </v-list-item>\n                </v-list>\n              </v-flex>\n            </v-row>\n          </v-container>\n        </v-card-text>\n\n        <v-divider></v-divider>\n\n        <v-card-actions>\n          <v-spacer></v-spacer>\n          <v-btn @click=\"clear_and_close\">\n            Cancel\n          </v-btn>\n          <v-btn color=\"primary\" @click=\"update_members\" :loading=\"btnloading\">\n            Save\n          </v-btn>\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n  </div>\n</template>\n<style scoped>\n#all_selected_wrapper {\n  max-height: 340px;\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n#filtered_by_search_wrapper {\n  max-height: 260px;\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n</style>\n\n<script>\nimport { api_to } from '@/modules/Chat/api'\nimport _cloneDeep from 'lodash/cloneDeep'\n\nexport default {\n  name: 'ManageClientChatMember',\n  props: {\n    conversation: Object\n  },\n  data() {\n    return {\n      dialog: false,\n      all_users: [],\n      filtered_by_search: [],\n      all_selected: [],\n      search: '',\n      btnloading: false\n    }\n  },\n  /* created() {\nlet uroles = Object.values(this.loggedUser.user_roles)[0]\n  console.log(uroles.includes('manager'))\n  },*/\n  computed: {\n    loggedUser() {\n      return this.$store.getters.user\n    }\n  },\n  methods: {\n    open_dialog() {\n      this.dialog = true\n      this.all_selected = _cloneDeep(this.conversation.members)\n      this.get_chat_list()\n    },\n    clear_and_close() {\n      this.dialog = false\n    },\n    get_chat_list_only() {\n      api_to.get_chat_list().then(({ data }) => {\n        this.filtered_by_search = this.filter_users_for_selected(data)\n        this.all_users = _cloneDeep(data)\n      })\n    },\n    update_members() {\n      this.btnloading = true\n      var payload = {\n        convo_id: this.conversation.id,\n        users: this.all_selected.map(value => {\n          return value.id\n        })\n      }\n      api_to\n        .update_members_list(payload)\n        .then(({ data }) => {\n          this.conversation.members = data\n          this.clear_and_close()\n        })\n        .finally(() => (this.btnloading = false))\n    },\n    can_be_remove(user) {\n      if (user.id === this.loggedUser.id) return false //cant delete self\n\n      if (user.is_company_owner) return false\n\n      if (this.loggedUser.is_company_owner) return true\n\n      let uroles = Object.values(this.loggedUser.user_roles)[0]\n\n      let roles = Object.values(user.user_roles)[0]\n\n      if (uroles.includes('admin') && roles.includes('admin')) {\n        //both admin\n        return false\n      } else if (uroles.includes('admin') && !roles.includes('admin')) {\n        return true\n      } else if (uroles.includes('manager') && roles.includes('manager')) {\n        //both manager\n        return false\n      } else if (uroles.includes('manager') && roles.includes('admin')) {\n        return false\n      }\n\n      if (uroles.includes('client') || uroles.includes('member')) {\n        return false\n      }\n\n      return true\n    },\n    select(item, value) {\n      let index = this.filtered_by_search.findIndex(user => item.id === user.id)\n      if (~index) {\n        this.filtered_by_search[index].is_selected = value\n      }\n    },\n    selected(item) {\n      let index = this.all_selected.findIndex(user => item.id === user.id)\n      if (~index) {\n        this.select(item, false)\n        this.all_selected.splice(index, 1)\n      } else {\n        this.select(item, true)\n        this.all_selected.push(item)\n      }\n    },\n\n    filter_users_for_selected(items) {\n      var selected_ids = this.conversation.members.map(value => {\n        return value.id\n      })\n      return items.map(item =>\n        Object.assign(item, { is_selected: selected_ids.indexOf(item.id) >= 0 })\n      )\n    },\n    filter_users(event) {\n      setTimeout(() => {\n        if (this.search && this.search !== '') {\n          this.filtered_by_search = _cloneDeep(this.all_users).filter(item => {\n            return item.fullname\n              .toLowerCase()\n              .includes(this.search.toLowerCase().trim())\n          })\n        } else {\n          this.filtered_by_search = _cloneDeep(this.all_users)\n        }\n      }, 1)\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ManageClientChatMember.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ManageClientChatMember.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ManageClientChatMember.vue?vue&type=template&id=1ed75cb6&scoped=true&\"\nimport script from \"./ManageClientChatMember.vue?vue&type=script&lang=js&\"\nexport * from \"./ManageClientChatMember.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ManageClientChatMember.vue?vue&type=style&index=0&id=1ed75cb6&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1ed75cb6\",\n  null\n  \n)\n\nexport default component.exports","<template>\n    <div class=\"message__body team-messages\">\n        <v-system-bar lights-out :height=\"40\" v-if=\"can_manage_members\">\n            <v-spacer></v-spacer>\n            <v-btn text small @click=\"open_manage_member_dialog\">Manage Members <v-icon right>settings</v-icon>\n            </v-btn>\n        </v-system-bar>\n        <div class=\"messages\" ref=\"messages-container\">\n            <v-row no-gutters class=\"pa-3\" v-if=\"can_send_message\">\n                <v-spacer></v-spacer>\n                <v-col>\n                    <v-btn text v-if=\"noMoreData === false && !loading\" class=\"view__more_btn overline\" @click=\"load_previous\">Load Previous Messages</v-btn>\n                </v-col>\n                <v-spacer></v-spacer>\n            </v-row>\n            <v-progress-linear v-if=\"loading\" :indeterminate=\"true\"></v-progress-linear>\n            <v-row no-gutters v-if=\"items.length && can_send_message\">\n                <v-col md=\"12\" class=\"px-3 py-2\" style=\"min-height: 350px;\">\n                    <Message v-for=\"message in messages(items)\" :message=\"message\" :key=\"message.id\"></Message>\n                </v-col>\n            </v-row>\n            <div class=\"no-messages\" v-else-if=\"!can_send_message\">\n                <Empty headline=\"Client messages unavailable! \"></Empty>\n            </div>\n            <div class=\"no-messages\" v-else>\n                <Empty headline=\"No messages yet\"></Empty>\n            </div>\n        </div>\n        <div class=\"write px-3\">\n            <ChatField v-if=\"can_send_message\" class=\"mt-2\" :mentionables=\"mentionables\" @typing=\"\" @send-message=\"sendMessage\"></ChatField>\n        </div>\n        <ManageClientChatMember ref=\"manage_group_members_dialog\" :conversation=\"activeChat\"></ManageClientChatMember>\n    </div>\n</template>\n<script>\nimport * as apiTo from './api'\nimport { global_utils } from '@/global_utils/global_utils'\nimport { list_functionality } from '@/services/list-functionality/list-functionality'\nimport _cloneDeep from 'lodash/cloneDeep'\n\n// Components\n\nimport Empty from '@/common/Empty.vue'\nimport ManageClientChatMember from '@/modules/ProjectPreview-Messages/components/ManageClientChatMember.vue'\nimport ChatField from '@/common/ChatBox/ChatField.vue'\nimport Message from '@/modules/Chat/components/Message/Message.vue'\n\nexport default {\n    name: 'ClientMessages',\n    mixins: [global_utils, list_functionality],\n    props: {\n        id: [Number, String]\n    },\n    components: {\n        Empty,\n        ManageClientChatMember,\n        ChatField,\n        Message\n    },\n\n    data: () => ({\n        loading: false,\n        message: null,\n        can_message: false,\n        activeChat: null\n    }),\n\n    computed: {\n        loggedUser() {\n            return this.$store.getters.user\n        },\n        can_manage_members() {\n            if (this.loggedUser.is_admin) return true\n            var role = Object.values(this.loggedUser.user_roles)[0]\n            return ~role.indexOf('manager') ? true : false\n        },\n        can_send_message() {\n            return this.can_message\n        },\n        mentionables() {\n            if (!this.activeChat) {\n                return []\n            }\n            return this.activeChat.members\n        },\n        type() {\n            return this.$route.params.type || 'project'\n        },\n        paths() {\n            return [\n                { text: 'Dashboard', disabled: false, router_name: 'default-content' },\n                { text: this.type, disabled: true, router_name: null },\n                { text: 'Client Message', disabled: true, router_name: null }\n            ]\n        }\n    },\n\n    created() {\n        this.getConvoDetails(this.id)\n    },\n    mounted() {\n        this.loading = true\n        this.$event.$emit('path-change', this.paths)\n        this.$pusher.authenticate()\n        this.subscribePusher()\n    },\n    beforeDestroy() {\n        this.$pusher.unsubscribe(`private-project.client-message.${this.id}`)\n    },\n    methods: {\n        open_manage_member_dialog() {\n            this.$refs.manage_group_members_dialog.open_dialog()\n        },\n        getConvoDetails(id) {\n            apiTo\n                .get_client_convo_details(id)\n                .then(({ data }) => {\n                    this.activeChat = data\n                })\n                .finally(() => {\n                    this.loading = false\n                })\n        },\n        scrollToBottomDiv() {\n            setTimeout(() => {\n                const wrapper = this.$refs['messages-container']\n                if (wrapper) {\n                    wrapper.scrollTop = wrapper.scrollHeight\n                }\n            }, 1)\n        },\n        load_previous() {\n            this.load_more_via_url(`api/projects/${this.id}/messages?type=client`)\n        },\n        add_new_message(message) {\n            if (!this.items.some(msg => msg.id === message.id)) {\n                this.items.unshift(message)\n            }\n        },\n        user_can_message(can) {\n            this.can_message = can\n            if (can) {\n                this.fill_table_via_url(`api/projects/${this.id}/messages?type=client`)\n                setTimeout(() => {\n                    this.scrollToBottomDiv()\n                }, 1)\n                console.log('Client chat connected')\n                // this.$event.$emit('open_snackbar', 'Client chat connected')\n            } else console.log('Client chat unavailable for you.')\n        },\n        subscribePusher() {\n            const client_message_channel = this.$pusher.subscribe(\n                `private-project.client-message.${this.id}`\n            )\n            client_message_channel.bind('ProjectClientMessage', data => {\n                if (data.type === 'client') this.add_new_message(data.message)\n            })\n            client_message_channel.bind('pusher:subscription_succeeded', () =>\n                this.user_can_message(true)\n            )\n            client_message_channel.bind('pusher:subscription_error', status =>\n                this.user_can_message(false)\n            )\n        },\n        sendMessage(data) {\n            let formData = new FormData()\n            formData.append('message', data.message)\n            formData.append('type', 'client')\n            formData.append('from_id', this.loggedUser.id)\n\n            if (data.files.length > 0) {\n                formData.append('file', data.files[0])\n            }\n\n            apiTo\n                .send_message(this.id, formData)\n                .then(({ data }) => {\n                    this.add_new_message(data)\n                })\n                .finally(() => {\n                    this.scrollToBottomDiv()\n                    this.$event.$emit('btnsending_off', false)\n                })\n        },\n        messages(items) {\n            return _cloneDeep(items).reverse()\n        }\n    }\n}\n</script>\n<style lang=\"scss\" scoped>\n@import '~@/sass/_variables';\n\n.message__body {\n    border: 1px solid $borderLightGray;\n    border-bottom-left-radius: 10px;\n    border-bottom-right-radius: 10px;\n\n    @include styledScrollFor('.messages'); //style the scroll\n\n    .messages {\n        background-color: $white;\n        overflow: auto;\n        max-height: 462px;\n        border-bottom: 1px solid $borderLightGray;\n    }\n\n    .write {\n        display: flex;\n        flex-direction: row;\n        flex-wrap: nowrap;\n        align-items: center;\n        background-color: $white;\n\n        .write__actions {\n            .action {\n                margin: 5px 7px;\n                color: $lightGray-2;\n                cursor: pointer;\n\n                &:hover {\n                    color: $blue;\n                }\n            }\n        }\n\n        .avatar-wrapper {\n            padding: 3px;\n\n            .sender-avatar {\n                width: 40px;\n            }\n        }\n    }\n\n    .view__more {\n        text-align: center;\n        padding: 10px;\n        border-top: 1px solid $borderLightGray;\n        background-color: $white;\n        border-bottom-left-radius: 10px;\n        border-bottom-right-radius: 10px;\n\n        .view__more_btn {\n            color: $tableDarkText;\n        }\n    }\n\n    .no-messages {\n        padding: 20px;\n        text-align: center;\n    }\n}\n</style>","import mod from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClientMessages.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/babel-loader/lib/index.js!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClientMessages.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ClientMessages.vue?vue&type=template&id=62089150&scoped=true&\"\nimport script from \"./ClientMessages.vue?vue&type=script&lang=js&\"\nexport * from \"./ClientMessages.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ClientMessages.vue?vue&type=style&index=0&id=62089150&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"62089150\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}