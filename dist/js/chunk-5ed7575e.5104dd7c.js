(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5ed7575e"],{"0621":function(e,t,n){var r=n("9e69"),i=n("d370"),a=n("6747"),c=r?r.isConcatSpreadable:void 0;function s(e){return a(e)||i(e)||!!(c&&e&&e[c])}e.exports=s},"08cc":function(e,t,n){var r=n("1a8c");function i(e){return e===e&&!r(e)}e.exports=i},"099a":function(e,t){function n(e,t,n){var r=n-1,i=e.length;while(++r<i)if(e[r]===t)return r;return-1}e.exports=n},"100e":function(e,t,n){var r=n("cd9d"),i=n("2286"),a=n("c1c9");function c(e,t){return a(i(e,t,r),e+"")}e.exports=c},1838:function(e,t,n){var r=n("c05f"),i=n("9b02"),a=n("8604"),c=n("f608"),s=n("08cc"),o=n("20ec"),u=n("f4d6"),l=1,f=2;function d(e,t){return c(e)&&s(t)?o(u(e),t):function(n){var c=i(n,e);return void 0===c&&c===t?a(n,e):r(t,c,l|f)}}e.exports=d},"18d8":function(e,t,n){var r=n("234d"),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,c=r((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(i,(function(e,n,r,i){t.push(r?i.replace(a,"$1"):n||e)})),t}));e.exports=c},"20ec":function(e,t){function n(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}e.exports=n},2286:function(e,t,n){var r=n("85e3"),i=Math.max;function a(e,t,n){return t=i(void 0===t?e.length-1:t,0),function(){var a=arguments,c=-1,s=i(a.length-t,0),o=Array(s);while(++c<s)o[c]=a[t+c];c=-1;var u=Array(t+1);while(++c<t)u[c]=a[c];return u[t]=n(o),r(e,this,u)}}e.exports=a},"234d":function(e,t,n){var r=n("e380"),i=500;function a(e){var t=r(e,(function(e){return n.size===i&&n.clear(),e})),n=t.cache;return t}e.exports=a},"26e8":function(e,t){function n(e,t){return null!=e&&t in Object(e)}e.exports=n},"2b03":function(e,t){function n(e,t,n,r){var i=e.length,a=n+(r?1:-1);while(r?a--:++a<i)if(t(e[a],a,e))return a;return-1}e.exports=n},"2eaa":function(e,t,n){var r=n("d612"),i=n("8db3"),a=n("5edf"),c=n("7948"),s=n("b047"),o=n("c584"),u=200;function l(e,t,n,l){var f=-1,d=i,v=!0,_=e.length,h=[],p=t.length;if(!_)return h;n&&(t=c(t,s(n))),l?(d=a,v=!1):t.length>=u&&(d=o,v=!1,t=new r(t));e:while(++f<_){var m=e[f],b=null==n?m:n(m);if(m=l||0!==m?m:0,v&&b===b){var g=p;while(g--)if(t[g]===b)continue e;h.push(m)}else d(t,b,l)||h.push(m)}return h}e.exports=l},"3bb4":function(e,t,n){var r=n("08cc"),i=n("ec69");function a(e){var t=i(e),n=t.length;while(n--){var a=t[n],c=e[a];t[n]=[a,c,r(c)]}return t}e.exports=a},4416:function(e,t){function n(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}e.exports=n},4751:function(e,t,n){"use strict";var r=n("7971"),i=n.n(r);i.a},"47f5":function(e,t,n){var r=n("2b03"),i=n("d9a8"),a=n("099a");function c(e,t,n){return t===t?a(e,t,n):r(e,i,n)}e.exports=c},"49e5":function(e,t,n){"use strict";var r=n("49f8"),i=n.n(r);i.a},"49f8":function(e,t,n){},"5c69":function(e,t,n){var r=n("087d"),i=n("0621");function a(e,t,n,c,s){var o=-1,u=e.length;n||(n=i),s||(s=[]);while(++o<u){var l=e[o];t>0&&n(l)?t>1?a(l,t-1,n,c,s):r(s,l):c||(s[s.length]=l)}return s}e.exports=a},"5edf":function(e,t){function n(e,t,n){var r=-1,i=null==e?0:e.length;while(++r<i)if(n(t,e[r]))return!0;return!1}e.exports=n},"642a":function(e,t,n){var r=n("966f"),i=n("3bb4"),a=n("20ec");function c(e){var t=i(e);return 1==t.length&&t[0][2]?a(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}e.exports=c},"656b":function(e,t,n){var r=n("e2e4"),i=n("f4d6");function a(e,t){t=r(t,e);var n=0,a=t.length;while(null!=e&&n<a)e=e[i(t[n++])];return n&&n==a?e:void 0}e.exports=a},"72f0":function(e,t){function n(e){return function(){return e}}e.exports=n},7971:function(e,t,n){},"7f60":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"message__tab"},[n("v-row",[n("v-col",{attrs:{md:"3"}},[n("UsersList",{attrs:{"has-manage-members":e.manageable,participants:e.participants,title:e.user_list_title},on:{"open-manage-members":e.manage_participants}})],1),n("v-col",{attrs:{md:"9"}},[n("v-tabs",{staticClass:"tabs",attrs:{centered:"",grow:"","hide-slider":"",height:"45","show-arrows":e.is_screen_medium_and_down},model:{value:e.active_chat_index,callback:function(t){e.active_chat_index=t},expression:"active_chat_index"}},e._l(e.chat_tabs,(function(t){return n("v-tab",{key:t.id,attrs:{disabled:t.is_disabled,exact:""}},[e._v(" "+e._s(t.name)+" ")])})),1),n("ChatBox",{attrs:{conversation:e.active_chat,"has-toolbar":!1}})],1)],1),n("ManageClientChatMember",{ref:"manage_group_members_dialog",attrs:{conversation:e.active_chat}})],1)},i=[],a=(n("8e6e"),n("ac6a"),n("456d"),n("20d6"),n("ade3")),c=(n("c5f6"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",{staticClass:"mx-auto users-list",attrs:{outlined:"",flat:""}},[n("v-toolbar",{attrs:{flat:"",color:"#3b589e",height:"45",dark:""}},[n("v-icon",{attrs:{large:"",left:""}},[e._v("mdi-wechat")]),n("v-toolbar-title",{staticClass:"subtitle-2"},[e._v(e._s(e.title))]),n("v-spacer"),e.hasManageMembers?n("v-icon",{on:{click:function(t){return e.$emit("open-manage-members")}}},[e._v("mdi-account-switch")]):e._e()],1),n("v-card-text",{staticClass:"pa-0"},[e.participants.length>0?[n("v-list",{attrs:{subheader:"",dense:""}},[n("v-subheader",[e._v("Members")]),e._l(e.participants,(function(e){return n("v-list-item",{key:e.id},[n("v-list-item-content",[n("Avatar",{attrs:{user:e}})],1)],1)}))],2)]:n("empty",{attrs:{headline:"No active conversation",icon:"mdi-wechat"}})],2),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{text:"",disabled:""}},[e._v("Load More")]),n("v-spacer")],1)],1)}),s=[],o={props:{participants:Array,hasManageMembers:{type:Boolean,default:!1},title:{type:String,default:"Team Chat"}}},u=o,l=(n("4751"),n("2877")),f=Object(l["a"])(u,c,s,!1,null,"3d2f1969",null),d=f.exports,v=n("dbc2"),_=n("8d9c"),h=n("1be9"),p=n("2f62"),m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.conversation?n("div",{staticClass:"text-center"},[n("v-dialog",{attrs:{"max-width":"800",persistent:"",scrollable:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",[n("v-card-title",{staticClass:"headline grey lighten-2",attrs:{"primary-title":""}},[e._v(" Manage Members "),n("v-spacer"),n("v-icon",{on:{click:function(t){return e.clear_and_close()}}},[e._v("close")])],1),n("v-card-text",[n("v-container",[n("v-row",[n("v-col",{attrs:{sm:"12",md:"8"}},[n("v-text-field",{attrs:{outlined:"",flat:"",label:"Search for people to add",required:"",clearable:"","prepend-inner-icon":"search"},on:{keydown:e.filter_users,"click:clear":e.filter_users},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),e.filtered_by_search.length>0?n("v-list",{attrs:{id:"filtered_by_search_wrapper"}},e._l(e.filtered_by_search,(function(t){return n("v-list-item",{key:t.title,on:{click:function(n){return e.selected(t)}}},[n("v-list-item-avatar",[n("v-img",{attrs:{src:t.image_url}})],1),n("v-list-item-content",[n("v-list-item-title",{domProps:{textContent:e._s(t.fullname)}})],1),n("v-list-item-icon",[n("v-icon",{directives:[{name:"show",rawName:"v-show",value:t.is_selected,expression:"item.is_selected"}],attrs:{color:"success"}},[e._v(" mdi-checkbox-marked-circle ")])],1)],1)})),1):e._e()],1),n("v-col",{attrs:{sm:"12",md:"4"}},[n("v-list",{attrs:{id:"all_selected_wrapper"}},[n("v-subheader",[e._v(" Selected ("+e._s(e.all_selected.length)+") ")]),e.all_selected.length>0?e._l(e.all_selected,(function(t){return n("v-list-item",{key:t.title},[n("v-list-item-avatar",[n("v-img",{attrs:{src:t.image_url}})],1),n("v-list-item-content",[n("v-list-item-subtitle",{domProps:{textContent:e._s(t.fullname)}})],1),e.can_be_remove(t)?n("v-list-item-icon",[n("v-icon",{attrs:{small:"",color:"danger"},on:{click:function(n){return e.selected(t)}}},[e._v(" close ")])],1):e._e()],1)})):e._e()],2)],1)],1)],1)],1),n("v-divider"),n("v-card-actions",[n("v-spacer"),n("v-btn",{on:{click:e.clear_and_close}},[e._v(" Cancel ")]),n("v-btn",{attrs:{color:"primary",loading:e.btnloading},on:{click:e.update_members}},[e._v(" Save ")])],1)],1)],1)],1):e._e()},b=[],g=(n("6762"),n("2fdb"),n("386d"),n("0644")),x=n.n(g),y=n("a125"),w=n.n(y);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){Object(a["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C={name:"ManageClientChatMember",props:{conversation:Object},data:function(){return{dialog:!1,all_users:[],filtered_by_search:[],all_selected:[],search:"",btnloading:!1}},computed:j({},Object(p["c"])(["user"])),methods:{open_dialog:function(){this.dialog=!0,this.all_selected=x()(this.conversation.users),this.get_project_all_members()},clear_and_close:function(){this.dialog=!1},get_project_all_members:function(){var e=this;h["a"].get("api/chat/conversations/project/".concat(this.conversation.project_id,"/members")).then((function(t){var n=t.data;e.all_users=x()(n),e.filtered_by_search=w()(n,e.all_selected,"id")}))},update_members:function(){var e=this;this.btnloading=!0;var t={conversation_id:this.conversation.id,users:this.all_selected.map((function(e){return e.id}))};h["a"].post("api/chat/conversations/".concat(conversation.id,"/members"),t).then((function(t){t.data;e.clear_and_close()})).finally((function(){return e.btnloading=!1}))},can_be_remove:function(e){if(e.is_client)return!1;if(e.id===this.user.id)return!1;if(e.is_company_owner)return!1;if(this.user.is_company_owner)return!0;var t=this.user;return(!t.is_admin||!e.is_admin)&&(!(!t.is_admin||e.is_admin)||(t.is_manager&&e.is_manager||t.is_manager&&e.is_manager,!1))},select:function(e,t){var n=this.filtered_by_search.findIndex((function(t){return e.id===t.id}));~n&&(this.filtered_by_search[n].is_selected=t)},selected:function(e){var t=this.all_selected.findIndex((function(t){return e.id===t.id}));~t?(this.select(e,!1),this.all_selected.splice(t,1)):(this.select(e,!0),this.all_selected.push(e))},filter_users_for_selected:function(e){var t=this.conversation.members.map((function(e){return e.id}));return e.map((function(e){return Object.assign(e,{is_selected:t.indexOf(e.id)>=0})}))},filter_users:function(e){var t=this;setTimeout((function(){t.search&&""!==t.search?t.filtered_by_search=x()(t.all_users).filter((function(e){return e.fullname.toLowerCase().includes(t.search.toLowerCase().trim())})):t.filtered_by_search=x()(t.all_users)}),1)}}},k=C,M=(n("cb2c"),Object(l["a"])(k,m,b,!1,null,"0fa8992b",null)),P=M.exports;function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){Object(a["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S={name:"Messages",mixins:[_["a"]],components:{ChatBox:v["a"],UsersList:d,ManageClientChatMember:P},props:{id:[String,Number]},data:function(){return{client_conversation:null,team_conversation:null,active_chat_index:0}},created:function(){this.getConversations()},computed:D(D({},Object(p["c"])(["user"])),{},{manageable:function(){return this.active_chat&&"client"===this.active_chat.type},active_chat:function(){return 1===this.active_chat_index?this.team_conversation:this.client_conversation},user_list_title:function(){return this.active_chat?"client"===this.active_chat.type?"Client Group Chat":"Team Group Chat":""},participants:function(){return this.active_chat?this.active_chat.users:[]},is_client_tab_disabled:function(){var e=this;if(this.user.is_admin)return!1;if(!this.client_conversation)return!0;var t=this.client_conversation.users.findIndex((function(t){return t.id===e.user.id}));return!~t},is_team_tab_disabled:function(){var e=this;if(this.user.is_admin)return!1;if(!this.team_conversation)return!0;var t=this.team_conversation.users.findIndex((function(t){return t.id===e.user.id}));return!~t},chat_tabs:function(){var e=this.$route.params.type||"project";return[{name:"Client Messages",route:"/dashboard/".concat(e,"/preview/").concat(this.id,"/messages"),conversation_id:this.client_conversation,is_disabled:this.is_client_tab_disabled},{name:"Team Messages",route:"/dashboard/".concat(e,"/preview/").concat(this.id,"/messages/team-messages"),conversation_id:this.team_conversation,is_disabled:this.is_team_tab_disabled}]}}),methods:{getConversations:function(){var e=this;h["a"].get("api/chat/conversations/project/".concat(this.id)).then((function(t){var n=t.data;e.client_conversation=n.client_conversation,e.team_conversation=n.team_conversation})).finally((function(){e.user.is_admin||e.user.is_manager||e.user.is_client?e.active_chat_index=0:e.active_chat_index=1}))},manage_participants:function(){this.active_chat&&this.$refs.manage_group_members_dialog.open_dialog()}}},E=S,A=(n("49e5"),Object(l["a"])(E,r,i,!1,null,"4683ac25",null));t["default"]=A.exports},"85e3":function(e,t){function n(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}e.exports=n},8604:function(e,t,n){var r=n("26e8"),i=n("e2c0");function a(e,t){return null!=e&&i(e,t,r)}e.exports=a},"8d9c":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={computed:{is_screen_medium_and_up:function(){return this.$vuetify.breakpoint.mdAndUp},is_screen_medium_and_down:function(){return this.$vuetify.breakpoint.mdAndDown},is_screen_small_and_down:function(){return this.$vuetify.breakpoint.smAndDown}}}},"8db3":function(e,t,n){var r=n("47f5");function i(e,t){var n=null==e?0:e.length;return!!n&&r(e,t,0)>-1}e.exports=i},"966f":function(e,t,n){var r=n("7e64"),i=n("c05f"),a=1,c=2;function s(e,t,n,s){var o=n.length,u=o,l=!s;if(null==e)return!u;e=Object(e);while(o--){var f=n[o];if(l&&f[2]?f[1]!==e[f[0]]:!(f[0]in e))return!1}while(++o<u){f=n[o];var d=f[0],v=e[d],_=f[1];if(l&&f[2]){if(void 0===v&&!(d in e))return!1}else{var h=new r;if(s)var p=s(v,_,d,e,t,h);if(!(void 0===p?i(_,v,a|c,s,h):p))return!1}}return!0}e.exports=s},"9b02":function(e,t,n){var r=n("656b");function i(e,t,n){var i=null==e?void 0:r(e,t);return void 0===i?n:i}e.exports=i},a125:function(e,t,n){var r=n("2eaa"),i=n("5c69"),a=n("badf"),c=n("100e"),s=n("dcbe"),o=n("4416"),u=c((function(e,t){var n=o(t);return s(n)&&(n=void 0),s(e)?r(e,i(t,1,s,!0),a(n,2)):[]}));e.exports=u},a454:function(e,t,n){var r=n("72f0"),i=n("3b4a"),a=n("cd9d"),c=i?function(e,t){return i(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:a;e.exports=c},af98:function(e,t,n){},badf:function(e,t,n){var r=n("642a"),i=n("1838"),a=n("cd9d"),c=n("6747"),s=n("f9ce");function o(e){return"function"==typeof e?e:null==e?a:"object"==typeof e?c(e)?i(e[0],e[1]):r(e):s(e)}e.exports=o},c1c9:function(e,t,n){var r=n("a454"),i=n("f3c1"),a=i(r);e.exports=a},cb2c:function(e,t,n){"use strict";var r=n("af98"),i=n.n(r);i.a},cd9d:function(e,t){function n(e){return e}e.exports=n},d9a8:function(e,t){function n(e){return e!==e}e.exports=n},dcbe:function(e,t,n){var r=n("30c9"),i=n("1310");function a(e){return i(e)&&r(e)}e.exports=a},e2c0:function(e,t,n){var r=n("e2e4"),i=n("d370"),a=n("6747"),c=n("c098"),s=n("b218"),o=n("f4d6");function u(e,t,n){t=r(t,e);var u=-1,l=t.length,f=!1;while(++u<l){var d=o(t[u]);if(!(f=null!=e&&n(e,d)))break;e=e[d]}return f||++u!=l?f:(l=null==e?0:e.length,!!l&&s(l)&&c(d,l)&&(a(e)||i(e)))}e.exports=u},e2e4:function(e,t,n){var r=n("6747"),i=n("f608"),a=n("18d8"),c=n("76dd");function s(e,t){return r(e)?e:i(e,t)?[e]:a(c(e))}e.exports=s},e380:function(e,t,n){var r=n("7b83"),i="Expected a function";function a(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(i);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var c=e.apply(this,r);return n.cache=a.set(i,c)||a,c};return n.cache=new(a.Cache||r),n}a.Cache=r,e.exports=a},e3f8:function(e,t,n){var r=n("656b");function i(e){return function(t){return r(t,e)}}e.exports=i},ef5d:function(e,t){function n(e){return function(t){return null==t?void 0:t[e]}}e.exports=n},f3c1:function(e,t){var n=800,r=16,i=Date.now;function a(e){var t=0,a=0;return function(){var c=i(),s=r-(c-a);if(a=c,s>0){if(++t>=n)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}e.exports=a},f4d6:function(e,t,n){var r=n("ffd6"),i=1/0;function a(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}e.exports=a},f608:function(e,t,n){var r=n("6747"),i=n("ffd6"),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,c=/^\w*$/;function s(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!i(e))||(c.test(e)||!a.test(e)||null!=t&&e in Object(t))}e.exports=s},f9ce:function(e,t,n){var r=n("ef5d"),i=n("e3f8"),a=n("f608"),c=n("f4d6");function s(e){return a(e)?r(c(e)):i(e)}e.exports=s}}]);
//# sourceMappingURL=chunk-5ed7575e.5104dd7c.js.map