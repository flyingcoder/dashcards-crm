(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c2559d1e"],{1168:function(t,e,i){},"4cb1":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"reports"},[t.reports.length>0?i("div",{staticClass:"body-wrapper"},[i("div",{staticClass:"reports-inner"},[i("v-tabs",{staticClass:"reports-tab",attrs:{grow:"","next-icon":"mdi-arrow-right-bold-circle-outline","prev-icon":"mdi-arrow-left-bold-circle-outline","show-arrows":t.is_screen_medium_and_down},model:{value:t.reports_selected,callback:function(e){t.reports_selected=e},expression:"reports_selected"}},[t._l(t.reports,(function(e,o){return i("v-tab",{key:o,staticClass:"text-none"},[i("img",{staticClass:"tab-img mr-2",attrs:{src:t.getIconFromUrl(e)}}),t._v(" "+t._s(e.title)+" ")])})),t._l(t.calculated_btn,(function(e){return i("v-tab",{key:e,staticClass:"reports-tab"},[i("v-menu",{attrs:{bottom:"",left:"","offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on,a=e.attrs;return[i("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var l=e.on;return[i("v-btn",t._g(t._b({staticClass:"text-none align-self-center ma-0",attrs:{block:"",tile:"",text:""}},"v-btn",a,!1),Object.assign({},l,o)),[i("v-icon",{staticClass:"mr-2",attrs:{color:"#8090aa"}},[t._v("mdi-plus-circle-multiple-outline ")]),t._v(" Add Report ")],1)]}}],null,!0)},[i("span",[t._v("Add Report")])])]}}],null,!0)},[i("v-list",{attrs:{dense:""}},[i("v-list-item",{on:{click:t.open_dialog}},[i("v-list-item-title",[i("v-icon",{attrs:{left:""}},[t._v("mdi-plus-circle-outline")]),t._v(" Add new report via link ")],1)],1),i("v-list-item",{on:{click:function(e){return t.open_add_report_via_template(null)}}},[i("v-list-item-title",[i("v-icon",{attrs:{left:""}},[t._v("mdi-plus-circle-outline")]),t._v(" Add new report via template ")],1)],1)],1)],1)],1)}))],2),i("v-tabs-items",{model:{value:t.reports_selected,callback:function(e){t.reports_selected=e},expression:"reports_selected"}},t._l(t.reports,(function(e,o){return i("v-tab-item",{key:o},[i("v-card",{attrs:{flat:""}},[i("v-card-text",[i("div",{staticClass:"reports-actions"},[i("v-spacer"),t.reports.length>=3?i("v-menu",{attrs:{bottom:"",left:"","offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on,a=e.attrs;return[i("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var l=e.on;return[i("v-icon",t._g(t._b({staticClass:"mx-1",attrs:{fab:""}},"v-icon",a,!1),Object.assign({},l,o)),[t._v(" mdi-plus-circle-multiple-outline ")])]}}],null,!0)},[i("span",[t._v("Add Report")])])]}}],null,!0)},[i("v-list",{attrs:{dense:""}},[i("v-list-item",{on:{click:t.open_dialog}},[i("v-list-item-title",[i("v-icon",{attrs:{left:""}},[t._v("mdi-plus-circle-outline")]),t._v(" Add new report via link ")],1)],1),i("v-list-item",{on:{click:function(e){return t.open_add_report_via_template(null)}}},[i("v-list-item-title",[i("v-icon",{attrs:{left:""}},[t._v("mdi-plus-circle-outline")]),t._v(" Add new report via template ")],1)],1)],1)],1):t._e(),i("v-icon",{staticClass:"mx-1",attrs:{fab:""},on:{click:function(i){return t.openEditDialog(e,e.id)}}},[t._v(" mdi-circle-edit-outline ")]),i("v-icon",{staticClass:"mx-1",attrs:{fab:""},on:{click:function(i){return t.openDeleteDialog(e.id)}}},[t._v(" mdi-delete-circle-outline ")])],1),i("div",{staticClass:"reports-content"},[i("div",{staticClass:"site-preview"},["template"===e.url?i("Response",{attrs:{items:e.props.template}}):e.props&&e.props.canIframe?i("ReportsSection",{attrs:{iframeSrc:e.url},on:{"iframe-loaded":t.iframe_loaded}}):e.props&&e.props.image?i("v-card",{staticClass:"mx-auto",attrs:{flat:""}},[i("v-list-item",[i("v-list-item-content",[i("v-alert",{attrs:{prominent:"",type:"warning"}},[i("v-row",{attrs:{align:"center"}},[i("v-col",{staticClass:"grow"},[t._v(" We are unable to load the site content because of the website restrictions. ")]),i("v-col",{staticClass:"shrink"},[i("v-btn",{attrs:{href:e.url,target:"_blank"}},[t._v(" Go to Site "),i("v-icon",{attrs:{right:""}},[t._v("mdi-arrow-right-bold")])],1)],1)],1)],1)],1)],1),i("v-img",{staticClass:"white--text align-end",attrs:{src:e.props.image}},[i("v-card-title",[t._v(t._s(e.props.title))])],1),i("v-card-subtitle",{staticClass:"pb-0 headline"},[t._v(" "+t._s(e.props.title)+" ")]),i("v-card-text",{staticClass:"text--primary"},[i("div",{staticClass:"subtitle"},[t._v(t._s(e.props.description))])]),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"orange",text:"",href:e.url,target:"_blank"}},[t._v(" Go to Site "),i("v-icon",{attrs:{right:""}},[t._v("mdi-arrow-right-bold")])],1)],1)],1):i("Empty",{attrs:{icon:"mdi-link-off",headline:""},scopedSlots:t._u([{key:"extra",fn:function(){return[i("v-alert",{attrs:{prominent:"",type:"warning"}},[i("v-row",{attrs:{align:"center"}},[i("v-col",{staticClass:"grow"},[t._v(" We are unable to load the site content because of the website restrictions. ")]),i("v-col",{staticClass:"shrink"},[i("v-btn",{attrs:{href:e.url,target:"_blank"}},[t._v(" Go to Site "),i("v-icon",{attrs:{right:""}},[t._v("mdi-arrow-right-bold")])],1)],1)],1)],1)]},proxy:!0}],null,!0)})],1)])])],1)],1)})),1)],1)]):i("div",{staticClass:"body-wrapper"},[i("Empty",{attrs:{headline:"No reports yet",icon:"mdi-alpha-r-box-outline"},scopedSlots:t._u([{key:"extra",fn:function(){return[i("v-menu",{attrs:{bottom:"",left:"","offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on,a=e.attrs;return[i("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function(e){var l=e.on;return[i("v-btn",t._g(t._b({attrs:{large:"",dark:"",color:"#3b589e"}},"v-btn",a,!1),Object.assign({},l,o)),[i("v-icon",{attrs:{left:""}},[t._v("mdi-plus-circle-multiple-outline")]),t._v(" Add Report ")],1)]}}],null,!0)},[i("span",[t._v("Add Report")])])]}}])},[i("v-list",{attrs:{dense:""}},[i("v-list-item",{on:{click:t.open_dialog}},[i("v-list-item-title",[i("v-icon",{attrs:{left:""}},[t._v("mdi-plus-circle-outline")]),t._v(" Add new report via link ")],1)],1),i("v-list-item",{on:{click:function(e){return t.open_add_report_via_template(null)}}},[i("v-list-item-title",[i("v-icon",{attrs:{left:""}},[t._v("mdi-plus-circle-outline")]),t._v(" Add new report via template ")],1)],1)],1)],1)]},proxy:!0}])})],1),i("DeleteDialog",{attrs:{"open-dialog":t.deleteDialog,title:"Delete Report","text-content":"Are you sure you want to delete this report?"},on:{"update:openDialog":function(e){t.deleteDialog=e},"update:open-dialog":function(e){t.deleteDialog=e},delete:t.deleteReport}}),i("ReportsAddDialog",{ref:"dialog",attrs:{id:t.id},on:{"report-added":t.add_new_report}}),i("ReportsEditDialog",{ref:"editDialog",attrs:{id:t.id},on:{"report-updated":t.reportUpdated}}),i("report-via-template",{attrs:{isEdit:!1,"open-dialog":t.add_report_via_template},on:{save:t.handleSaveReportViaTemplate,"update:openDialog":function(e){t.add_report_via_template=e},"update:open-dialog":function(e){t.add_report_via_template=e}}}),i("report-via-template",{attrs:{isEdit:!0,title:"Edit Report",report:t.activeReport,"open-dialog":t.edit_report_via_template},on:{save:t.handleUpdateReportViaTemplate,"update:openDialog":function(e){t.edit_report_via_template=e},"update:open-dialog":function(e){t.edit_report_via_template=e}}})],1)},a=[],l=(i("20d6"),i("c5f6"),i("d4e9")),r=i("1be9"),n={deleteReport:function(t){return r["a"].delete("api/report/".concat(t))},updateReport:function(t,e){return r["a"].put("api/report/".concat(t),e)},saveReportViaTemplate:function(t){return r["a"].post("api/report/via-template",t)},updateReportViaTemplate:function(t,e){return r["a"].put("api/report/".concat(t,"/via-template"),e)}},s=i("8d9c"),d=i("57e5"),c=i("7b5c"),p=i("29d6"),u=i("69be"),v=i("5b70"),_=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("custom-dialog",{ref:"dialog",attrs:{title:"Edit Link","button1-text":"Cancel"},on:{button1:t.close_dialog},scopedSlots:t._u([{key:"content",fn:function(){return[i("v-layout",{staticClass:"custom-dialog",attrs:{wrap:""}},[i("v-flex",{attrs:{xs12:""}},[i("v-text-field",{staticClass:"dialog__textfield d-field",attrs:{label:"Title",filled:"",clearable:"","hide-details":"","prepend-icon":"text_fields",color:"#657186"},model:{value:t.title,callback:function(e){t.title="string"===typeof e?e.trim():e},expression:"title"}})],1),i("v-flex",{attrs:{xs12:""}},[i("v-text-field",{staticClass:"dialog__link d-field",attrs:{pattern:"https://.*",type:"url","prepend-icon":"link",label:"https://",clearable:"",filled:"","hide-details":"",color:"#657186"},on:{keydown:t.validate_url},model:{value:t.link,callback:function(e){t.link="string"===typeof e?e.trim():e},expression:"link"}})],1)],1)]},proxy:!0}])},[i("template",{slot:"button2"},[i("v-btn",{attrs:{disabled:t.is_disabled},on:{click:t.on_dialog_save}},[t._v("Save")])],1)],2)},f=[],m=(i("b54a"),{components:{CustomDialog:d["a"]},props:{id:[Number,String]},data:function(){return{link:"",title:"",valid_url:!1,reportId:null,reportIndex:null}},computed:{is_disabled:function(){return!this.link||!this.valid_url||!this.title}},methods:{open_dialog:function(t,e){var i=t.id,o=t.url,a=t.title;this.link=o,this.title=a,this.reportId=i,this.reportIndex=e,this.$refs.dialog.open_dialog(),this.valid_url=!0},close_dialog:function(){this.$refs.dialog.close_dialog()},clear_and_close:function(){this.close_dialog(),Object.assign(this.$data,this.$options.data.apply(this))},validate_url:function(t){var e=this;this.$nextTick((function(){e.valid_url=t.target.validity.valid}))},on_dialog_save:function(){var t=this;this.$store.commit("set_custom_loader",!0),n.updateReport(this.reportId,{url:this.link,title:this.title}).then((function(e){var i=e.data;t.$emit("report-updated",{data:i,index:t.reportIndex}),t.$event.$emit("open_snackbar","Report successfully updated.","success"),t.clear_and_close()})).finally((function(){return t.$store.commit("set_custom_loader",!1)}))}}}),h=m,g=i("2877"),b=Object(g["a"])(h,_,f,!1,null,null,null),k=b.exports,x=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("custom-dialog",{ref:"dialog",attrs:{title:"Add Link","button1-text":"Cancel"},on:{button1:t.close_dialog},scopedSlots:t._u([{key:"content",fn:function(){return[i("v-layout",{staticClass:"custom-dialog",attrs:{wrap:""}},[i("v-flex",{attrs:{xs12:""}},[i("v-text-field",{staticClass:"dialog__textfield d-field",attrs:{label:"Title",filled:"",clearable:"","hide-details":"","prepend-icon":"text_fields",color:"#657186"},model:{value:t.title,callback:function(e){t.title="string"===typeof e?e.trim():e},expression:"title"}})],1),i("v-flex",{attrs:{xs12:""}},[i("v-text-field",{staticClass:"dialog__link d-field",attrs:{pattern:"https://.*",type:"url","prepend-icon":"link",label:"https://",clearable:"",filled:"","hide-details":"",color:"#657186"},on:{keydown:t.validate_url},model:{value:t.link,callback:function(e){t.link="string"===typeof e?e.trim():e},expression:"link"}})],1)],1)]},proxy:!0}])},[i("template",{slot:"button2"},[i("v-btn",{attrs:{disabled:t.is_disabled},on:{click:t.on_dialog_save}},[t._v("Save")])],1)],2)},y=[],w={components:{CustomDialog:d["a"]},props:{id:[Number,String]},data:function(){return{link:"",title:"",valid_url:!1}},computed:{is_disabled:function(){return!this.link||!this.valid_url||!this.title}},methods:{open_dialog:function(){this.$refs.dialog.open_dialog()},close_dialog:function(){this.$refs.dialog.close_dialog()},clear_and_close:function(){this.close_dialog(),Object.assign(this.$data,this.$options.data.apply(this))},validate_url:function(t){var e=this;this.$nextTick((function(){e.valid_url=t.target.validity.valid}))},on_dialog_save:function(){var t=this;this.$store.commit("set_custom_loader",!0),l["a"].add_new_report({url:this.link,title:this.title}).then((function(e){var i=e.data;t.$emit("report-added",i),t.$event.$emit("open_snackbar","Report successfully added.","success"),t.clear_and_close()})).finally((function(){return t.$store.commit("set_custom_loader",!1)}))}}},R=w,$=Object(g["a"])(R,x,y,!1,null,null,null),C=$.exports,D=i("de18"),S=i("db18"),I={name:"Reports",mixins:[s["a"]],components:{CustomDialog:d["a"],ReportsList:c["a"],TableHeader:p["a"],ReportsSection:u["a"],DeleteDialog:v["a"],ReportsEditDialog:k,ReportsAddDialog:C,ReportViaTemplate:D["a"],Response:S["a"]},props:{id:[Number,String]},data:function(){return{paths:[{text:"Dashboard",disabled:!1,route:{name:"default-content"}},{text:"Reports",disabled:!0,route:null}],reports:[],loading:!1,iframeSrc:null,link:"",title:"",valid_url:!1,activateSave:!1,activeReport:null,deleteDialog:!1,deleteReportId:null,reportIdToEdit:null,reports_selected:null,add_report_via_template:!1,edit_report_via_template:!1}},computed:{calculated_btn:function(){return this.reports.length>=3?0:2===this.reports.length?1:1===this.reports.length?2:3}},created:function(){this.loadReports()},mounted:function(){this.$event.$emit("path-change",this.paths)},methods:{loadReports:function(){var t=this;this.loading=!0,l["a"].get_reports().then((function(e){var i=e.data;t.reports=i.data})).finally((function(){return t.loading=!1}))},open_dialog:function(){this.$refs.dialog.open_dialog()},openDeleteDialog:function(t){this.deleteReportId=t,this.deleteDialog=!0},openEditDialog:function(t,e){"template"===t.url?(this.activeReport=t,this.edit_report_via_template=!0):this.$refs.editDialog.open_dialog(t,e)},iframe_loaded:function(){this.activateSave=!0,this.$store.commit("set_custom_loader",!1)},validate_url:function(t){var e=this;this.$nextTick((function(){e.valid_url=t.target.validity.valid}))},getIconFromUrl:function(t){var e="template"!==t.url?new URL(t.url).host:"crm.dashcards.com";return"https://www.google.com/s2/favicons?domain=".concat(e,"&alt=feed")},previewRowUrl:function(t){this.reports_selected=this.reports.length-1},add_new_report:function(t){this.reports.push(t),this.previewRowUrl(t),this.$event.$emit("btnloading_off",!1)},deleteReport:function(){var t=this;this.$store.commit("set_custom_loader",!0),n.deleteReport(this.deleteReportId).then((function(){var e=t.reports.findIndex((function(e){return e.id===t.deleteReportId}));~e&&(t.reports.splice(e,1),t.activeReport=null,t.$event.$emit("open_snackbar","Report deleted successfully"))})).finally((function(){t.deleteDialog=!1,t.$store.commit("set_custom_loader",!1),t.$event.$emit("btnloading_off",!1)}))},reportUpdated:function(t){var e=t.data,i=(t.index,this.reports.findIndex((function(t){return t.id===e.id})));~i&&this.reports.splice(i,1,e),this.$event.$emit("btnloading_off",!1)},open_add_report_via_template:function(t){this.add_report_via_template=!0},handleSaveReportViaTemplate:function(t){var e=this;this.$store.commit("set_custom_loader",!0),n.saveReportViaTemplate(t).then((function(t){var i=t.data;e.reports.push(i),e.previewRowUrl(i),e.add_report_via_template=!1})).finally((function(){e.$store.commit("set_custom_loader",!1)}))},handleUpdateReportViaTemplate:function(t){var e=this;this.$store.commit("set_custom_loader",!0),n.updateReportViaTemplate(this.activeReport.id,t).then((function(t){var i=t.data,o=e.reports.findIndex((function(t){return t.id===i.id}));~o&&(e.reports.splice(o,1,i),e.previewRowUrl(i)),e.edit_report_via_template=!1})).finally((function(){e.$store.commit("set_custom_loader",!1)}))}}},T=I,A=(i("5d6c"),Object(g["a"])(T,o,a,!1,null,"894bcd02",null));e["default"]=A.exports},"5d6c":function(t,e,i){"use strict";var o=i("1168"),a=i.n(o);a.a}}]);
//# sourceMappingURL=chunk-c2559d1e.ce559ece.js.map