(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0877cfd4"],{1764:function(s,e,t){"use strict";var a=t("d739"),n=t.n(a);n.a},"1e4c":function(s,e,t){"use strict";t.d(e,"a",(function(){return n})),t.d(e,"b",(function(){return i}));var a=t("1be9"),n=function(s){return a["a"].get("api/projects/".concat(s,"/messages?type=team"))},i=function(s,e){return a["a"].post("api/projects/".concat(s,"/messages"),e)}},"572b":function(s,e,t){"use strict";var a=t("b2bb"),n=t.n(a);n.a},5979:function(s,e,t){"use strict";var a=function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div",{staticClass:"message",class:{me:s.isMyMessage}},[t("v-layout",{staticClass:"sender",attrs:{wrap:""}},[t("v-flex",{staticClass:"sender__img",attrs:{xs3:""}},[t("v-img",{attrs:{src:s.message.sender.image_url}}),t("span",{staticClass:"status online"})],1),t("v-flex",{staticClass:"sender__name",attrs:{xs5:""}},[t("h5",[s._v(s._s(s.message.sender.first_name)+" "+s._s(s.message.sender.last_name))])]),t("v-flex",{staticClass:"date",attrs:{xs4:""}},[s._v(" "+s._s(s._f("from_now")(s.message.created_at))+" ")])],1),t("div",{staticClass:"sender__message"},[s._v(" "+s._s(s.message.body)+" ")])],1)},n=[],i=t("579d"),r={mixins:[i["a"]],props:{isMyMessage:Boolean,message:Object}},c=r,o=(t("1764"),t("2877")),u=Object(o["a"])(c,a,n,!1,null,"00151108",null);e["a"]=u.exports},"7e6a":function(s,e,t){"use strict";var a=t("e992"),n=t.n(a);n.a},"854b":function(s,e,t){"use strict";var a=function(s,e){var t=e._c;return e.props.loading?t("transition",{attrs:{name:"fade"}},[t("div",{staticClass:"custom-loader"},[t("v-progress-circular",{attrs:{indeterminate:"",color:"primary",size:72}})],1)]):e._e()},n=[],i={props:{loading:Boolean}},r=i,c=(t("7e6a"),t("2877")),o=Object(c["a"])(r,a,n,!0,null,"0a16da3c",null);e["a"]=o.exports},b2bb:function(s,e,t){},d739:function(s,e,t){},dd50:function(s,e,t){"use strict";t.r(e);var a=function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div",{staticClass:"message__body team-messages"},[t("div",{ref:"messages-container",staticClass:"messages"},[t("Loader",{attrs:{loading:s.loading}}),s.messages.length?s._l(s.messages,(function(e){return t("SingleMessage",{key:e.id,attrs:{"is-my-message":e.sender.id===s.loggedUser.id,message:e}})})):t("div",{staticClass:"no-messages"},[s._v(" No messages yet ")])],2),t("div",{staticClass:"write"},[t("div",{staticClass:"avatar-wrapper"},[t("img",{staticClass:"sender-avatar",attrs:{src:s.loggedUser.image_url}})]),t("v-text-field",{staticClass:"write__msg",attrs:{solo:"",flat:"","hide-details":"",color:"#667187",label:"Type a message..."},on:{keyup:function(e){return!e.type.indexOf("key")&&s._k(e.keyCode,"enter",13,e.key,"Enter")?null:s.sendMessage(e.target.value)}},model:{value:s.message,callback:function(e){s.message=e},expression:"message"}}),t("div",{staticClass:"write__actions"},[t("v-icon",{staticClass:"action insert__emoticon"},[s._v("insert_emoticon")]),t("v-icon",{staticClass:"action attach_file"},[s._v("attach_file")]),t("v-icon",{staticClass:"action send",on:{click:function(e){return s.sendMessage(s.message)}}},[s._v("send")])],1)],1),t("div",{staticClass:"view__more"},[t("v-btn",{staticClass:"view__more_btn",attrs:{text:""}},[s._v("VIEW MORE")])],1)])},n=[],i=(t("c5f6"),t("1be9")),r=t("1e4c"),c=function(s){return i["a"].get("api/projects/".concat(s,"/messages?type=client"))},o=t("579d"),u=t("854b"),l=t("5979"),d={mixins:[o["a"]],props:{id:[Number,String]},components:{Loader:u["a"],SingleMessage:l["a"]},data:function(){return{loading:!1,messages:[],message:null,can_message:!1}},computed:{loggedUser:function(){return this.$store.getters.user}},created:function(){var s=this;this.loading=!0,c(this.id).then((function(e){var t=e.data;s.messages=t.data,s.scrollToBottom(s.$refs["messages-container"])})).finally((function(){return s.loading=!1}))},mounted:function(){this.$pusher.authenticate(),this.subscribePusher()},beforeDestroy:function(){this.$pusher.unsubscribe("private-project.client-message.".concat(this.id))},methods:{add_new_message:function(s){this.messages.some((function(e){return e.id===s.id}))||this.messages.push(s),this.scrollToBottom(this.$refs["messages-container"])},user_can_message:function(s){this.can_message=s,s?this.$event.$emit("open_snackbar","Client chat connected"):this.$event.$emit("open_snackbar","Client chat unavailable for you.","error")},subscribePusher:function(){var s=this,e=this.$pusher.subscribe("private-project.client-message.".concat(this.id));e.bind("ProjectClientMessage",(function(e){"client"===e.type&&s.add_new_message(e.message)})),e.bind("pusher:subscription_succeeded",(function(){return s.user_can_message(!0)})),e.bind("pusher:subscription_error",(function(e){return s.user_can_message(!1)}))},sendMessage:function(s){var e=this;if(s){this.message=null;var t={type:"client",message:s,from_id:this.loggedUser.id};r["b"](this.id,t).then((function(s){var t=s.data;e.add_new_message(t)}))}}}},g=d,m=(t("572b"),t("2877")),_=Object(m["a"])(g,a,n,!1,null,"12d34468",null);e["default"]=_.exports},e992:function(s,e,t){}}]);
//# sourceMappingURL=chunk-0877cfd4.8fcfc366.js.map