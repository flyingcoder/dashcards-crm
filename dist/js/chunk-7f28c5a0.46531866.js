(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7f28c5a0"],{"1e4c":function(e,s,t){"use strict";t.d(s,"a",(function(){return n})),t.d(s,"b",(function(){return i}));var a=t("1be9"),n=function(e){return a["a"].get("api/projects/".concat(e,"/messages?type=team"))},i=function(e,s){return a["a"].post("api/projects/".concat(e,"/messages"),s)}},3416:function(e,s,t){"use strict";var a=t("3f9e"),n=t.n(a);n.a},"3f9e":function(e,s,t){},"579d":function(e,s,t){"use strict";t.d(s,"a",(function(){return n}));t("c1df"),t("7f45");var a=t("7eac"),n={methods:{scrollToBottom:function(e){this.$nextTick((function(){e.scrollTop=e.scrollHeight-e.getBoundingClientRect().height}))},addHost:function(e){return"undefined"===typeof e?a["a"].apiHostBaseURL:0!==e.indexOf("http://")&&0!==e.indexOf("https://")?a["a"].apiHostBaseURL+e:e},altImage:function(e){e.hasOwnProperty("collection_name")&&"project.files.videos"===e.collection_name?(e.thumb_url=t("7335"),e.public_url=t("7335")):(e.thumb_url=t("e55f"),e.public_url=t("e55f"))},generate_random:function(e,s,t){for(var a=[],n=0;n<e;n++)a.push(parseInt((Math.random()*(t-s)+s).toFixed(0)));return a}}}},5979:function(e,s,t){"use strict";var a=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"message",class:{me:e.isMyMessage}},[t("v-layout",{staticClass:"sender",attrs:{wrap:""}},[t("v-flex",{staticClass:"sender__img",attrs:{xs3:""}},[t("v-img",{attrs:{src:e.message.sender.image_url}}),t("span",{staticClass:"status",class:e.is_online})],1),t("v-flex",{staticClass:"sender__name",attrs:{xs5:""}},[t("h5",[e._v(e._s(e.message.sender.first_name)+" "+e._s(e.message.sender.last_name))])]),t("v-flex",{staticClass:"date",attrs:{xs4:""}},[e._v(" "+e._s(e._f("from_now")(e.message.created_at))+" ")])],1),t("div",{staticClass:"sender__message"},[e._v(" "+e._s(e.message.body)+" ")])],1)},n=[],i=(t("20d6"),t("579d")),r={mixins:[i["a"]],props:{isMyMessage:Boolean,message:Object},computed:{is_online:function(){var e=this,s=this.$store.getters["onlineUsers/all_users"],t=s.findIndex((function(s){return s.id===e.message.sender.id}));return~t?"online":"offline"}}},c=r,o=(t("3416"),t("2877")),A=Object(o["a"])(c,a,n,!1,null,"7a2263c5",null);s["a"]=A.exports},7335:function(e,s,t){e.exports=t.p+"img/no-video-preview.6c0717ce.png"},"7e6a":function(e,s,t){"use strict";var a=t("e992"),n=t.n(a);n.a},"854b":function(e,s,t){"use strict";var a=function(e,s){var t=s._c;return s.props.loading?t("transition",{attrs:{name:"fade"}},[t("div",{staticClass:"custom-loader"},[t("v-progress-circular",{attrs:{indeterminate:"",color:"primary",size:72}})],1)]):s._e()},n=[],i={props:{loading:Boolean}},r=i,c=(t("7e6a"),t("2877")),o=Object(c["a"])(r,a,n,!0,null,"0a16da3c",null);s["a"]=o.exports},"8f2c":function(e,s,t){"use strict";var a=t("dcd0"),n=t.n(a);n.a},dcd0:function(e,s,t){},e55f:function(e,s){e.exports="data:image/jpeg;base64,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"},e75c:function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"message__body team-messages"},[t("div",{ref:"messages-container",staticClass:"messages"},[t("Loader",{attrs:{loading:e.loading}}),e.messages.length?e._l(e.messages,(function(s){return t("SingleMessage",{key:s.id,attrs:{"is-my-message":s.sender.id===e.loggedUser.id,message:s}})})):e._e()],2),t("div",{staticClass:"write"},[t("div",{staticClass:"avatar-wrapper"},[t("img",{staticClass:"sender-avatar",attrs:{src:e.loggedUser.image_url}})]),t("v-text-field",{staticClass:"write__msg",attrs:{solo:"",flat:"","hide-details":"",color:"#667187",label:"Type a message..."},on:{keyup:function(s){return!s.type.indexOf("key")&&e._k(s.keyCode,"enter",13,s.key,"Enter")?null:e.sendMessage(s.target.value)}},model:{value:e.message,callback:function(s){e.message=s},expression:"message"}}),t("div",{staticClass:"write__actions"},[t("v-icon",{staticClass:"action insert__emoticon"},[e._v("insert_emoticon")]),t("v-icon",{staticClass:"action attach_file"},[e._v("attach_file")]),t("v-icon",{staticClass:"action send",on:{click:function(s){return e.sendMessage(e.message)}}},[e._v("send")])],1)],1),t("div",{staticClass:"view__more"},[t("v-btn",{staticClass:"view__more_btn",attrs:{text:""}},[e._v("VIEW MORE")])],1)])},n=[],i=(t("c5f6"),t("1e4c")),r=t("579d"),c=t("854b"),o=t("5979"),A={mixins:[r["a"]],props:{id:[Number,String]},components:{Loader:c["a"],SingleMessage:o["a"]},data:function(){return{loading:!1,messages:[],message:null,can_message:!1}},computed:{loggedUser:function(){return this.$store.getters.user}},mounted:function(){this.$pusher.authenticate(),this.subscribePusher()},beforeDestroy:function(){this.$pusher.unsubscribe("private-project.team-message.".concat(this.id))},created:function(){var e=this;this.loading=!0,i["a"](this.id).then((function(s){var t=s.data;e.messages=t.data,e.scrollToBottom(e.$refs["messages-container"])})).finally((function(){return e.loading=!1}))},methods:{add_new_message:function(e){this.messages.some((function(s){return s.id===e.id}))||this.messages.push(e),this.scrollToBottom(this.$refs["messages-container"])},user_can_message:function(e){this.can_message=e,e?this.$event.$emit("open_snackbar","Team chat connected"):this.$event.$emit("open_snackbar","Team chat disconnected.","error")},subscribePusher:function(){var e=this,s=this.$pusher.subscribe("private-project.team-message.".concat(this.id));s.bind("ProjectTeamMessage",(function(s){"team"===s.type&&e.add_new_message(s.message)})),s.bind("pusher:subscription_succeeded",(function(){return e.user_can_message(!0)})),s.bind("pusher:subscription_error",(function(s){return e.user_can_message(!1)}))},sendMessage:function(e){var s=this;if(e){this.message=null;var t={type:"team",message:e,from_id:this.loggedUser.id};i["b"](this.id,t).then((function(e){var t=e.data;s.add_new_message(t)}))}}}},g=A,u=(t("8f2c"),t("2877")),d=Object(u["a"])(g,a,n,!1,null,"4ac4f517",null);s["default"]=d.exports},e992:function(e,s,t){}}]);
//# sourceMappingURL=chunk-7f28c5a0.46531866.js.map